% @Olivier Décommente les ~1240 prochaines lignes, puis les 4 dernieres
% La balise @Olivier t'aidera

% Pour compiler (les options -output-directory=build sont importantes pour les packages)
% Les 6 commandes suivantes sont à faire dans un terminal la première fois
% puis seul pdflatex suffira si tu ne modifie pas les glossaires et la biblio
% pdflatex -shell-escape -file-line-error --synctex=1 --output-directory=build chapitre_05
% biber --output-directory=build chapitre_05
% makeglossaries -d build chapitre_05
% pdflatex -shell-escape -file-line-error --synctex=1 --output-directory=build chapitre_05
% pdflatex -shell-escape -file-line-error --synctex=1 --output-directory=build chapitre_05

\documentclass[12pt,%
    twoside,% twoside si document final
    a4paper,%
    openright, % openright si document final
    ]{book}

%\usepackage{cmbright} % fichier + lisible sur ordi, - lisible sur papier
\usepackage[utf8]{inputenc} %gestion des accents par le compilateurs
\usepackage[T1]{fontenc}

%%% LES POLICES

% Fonte Latin Modern
\usepackage{lmodern} % fontes tailles variables
    % substitution des petites capitales grasses manquantes
    % \rmfamily
    % \DeclareFontShape{T1}{lmr}{b}{sc}{<->ssub*cmr/bx/sc}{}
    % \DeclareFontShape{T1}{lmr}{bx}{sc}{<->ssub*cmr/bx/sc}{}

%% Fonte Fourier + Utopia
% \usepackage{fourier}
%     \usepackage[scaled=0.875]{helvet} % completement empatemment
%     \usepackage{courier} % completement chasse fixe

%% Fonte MathDesign + Utopia
% \usepackage[utopia]{mathdesign}

% % Fonte KP
% \usepackage{kpfonts}

% % Fonte Computer Modern Bright
% \usepackage{cmbright}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[french]{babel} % traduction des packages

\usepackage{microtype}

\usepackage{tabularx} % Permet d'utiliser l'environnement tabularx
\usepackage{graphicx} % gestion de figure, dessins
\usepackage[dvipsnames]{xcolor} % charge des couleurs

\usepackage{xspace}
\usepackage[%
    % paperwidth=270.0mm,%  A supprimer si plus besoin de todonotes
    headheight=14pt,%
    top    = 2.5cm,%
    bottom = 2.5cm,%
    inner  = 3.5cm,%
    outer  = 2.5cm,%
    a4paper]{geometry} % feuille a4 de taille 21.0 x 29.7

% suite de paquets mathematiques
\usepackage{amsfonts} % gestions des polices mathématques
\usepackage{amssymb} % plus de symbole
\usepackage[leqno]{amsmath} % legno : numéro des équations à gauche
    \everymath{\displaystyle} % Tout en grand !
    \numberwithin{equation}{section} % (x.y.z) x: chapitre, y: section, z: numéro equation
    \allowdisplaybreaks % Equations sur plusieurs pages et lignes si besoins

\usepackage{amsthm} % gestion des théoremes
    %\newtheorem{env_name}{Titre environement}[chapter/section/subsection/...]
    %\newtheorem{env_name}[reference_env_name]{Titre environement}
    \newtheorem{thm}{Théorème}[chapter] % Environnment thm numéroté sur chaptre : x.z
    \newtheorem{lemme}[thm]{Lemme}
    \newtheorem{prop}[thm]{Proposition}
    \newtheorem{defn}[thm]{Définition}
    \newtheorem{hyp}[thm]{Hypothèse}
    \newtheorem{remark}[thm]{Remark}
    \newtheorem{lemma}[thm]{Lemma}
% \usepackage{thmbox}
% \newtheorem[style=M,bodystyle={\noindent}]{thm}{Théorème}[chapter]
% \newtheorem[style=M,bodystyle={\noindent}]{lemme}{Lemme}[chapter]
% \newtheorem[style=S,underline=false,bodystyle={\noindent}]{prop}{Propriété}[chapter]
% \newtheorem[style=S,underline=false,bodystyle={\noindent}]{defn}{Définition}[chapter]
% \newtheorem[style=S,underline=false,bodystyle={\noindent}]{hyp}{Hypothèse}[chapter]

\usepackage{stmaryrd}

\usepackage[autostyle=true]{csquotes}

\usepackage[%
    language=english,%
    sorting=nyt,%
    backend=biber,%
    style=authoryear,%
    hyperref=true,%
    giveninits=true, % initialles pour prénoms
    isbn=true,%
    url=false,%
    maxcitenames=1,% Dans le texte, un seul auteur puis et al
    doi=true,%
    backref=true,% affiche les pages où l'auteur est cité
    backrefstyle=three% si cité en page 1,2,3, ecrire 1-3,
    ]{biblatex}

    \renewbibmacro{in:}{}
    \DeclareFieldFormat[book,report]{title}{\mkbibquote{#1\isdot}}
    \DefineBibliographyStrings{french}{%
    bibliography = {Références},
    }
    \bibliography{bib/from_zotero}
    \setlength\bibitemsep{0.5\baselineskip} % more space between bib entries
    \setlength\bibinitsep{1.5\baselineskip} % more space between bib entries with different letters

\usepackage[%
    linkcolor=blue!70!black,%
    colorlinks=true,%
    citecolor=purple,%
    bookmarksopen=true,% à l'ouverture du document, affiche les signets
    bookmarksnumbered=true,% Numérotes les signets
    bookmarksopenlevel=5, % Affiche dans les signets jusqu'au niveau 5 ( sub sub section )
    ]{hyperref} % gestion des liens hypertexts et reférences

\usepackage[section]{placeins} % Place un FloatBarrier à chaque nouvelle section, les figures s'y arreterons

\usepackage{epigraph} % Pour faire de jolie citations
    \newcommand{\citationChap}[2]{\epigraph{\og \textit{#1} \fg{}}{#2}}

% Jolie en tete de chapitre
\usepackage[Lenny]{fncychap}
    \makeatletter
        \ChNameVar{\huge} % On modifie la taille du môt ``Chapitre''
    \makeatother

\usepackage{caption} % Faire des caption en dehors de figure

\usepackage[francais]{minitoc}   % Mini table des matières, en français
    \setcounter{minitocdepth}{2} % Mini-toc détaillées (sections & sous-sections)



%\usepackage{multicol} % texte sur plusieurs colonnes
%\usepackage{wrapfig} % permet de gérer les flotants dans les multiples colonnes
\usepackage[%
    nomain,%
    sanitizesort=false,%
    style=super4col%
    ]{glossaries} %voir preambule_glossaire.tex

% Permet de tracer des figures et schémas
\usepackage{pgfplots}
    \usepgfplotslibrary{external} % On génère un pdf par graphique qui sera inclus après => 1ere compil un peu plus lente, suivante tres rapide
    
    \tikzexternalize{chapitre_05} % Cette commande doit être placé dans le main.tex pour qu'Overleaf puisse fonctionner 
    % Le graphique triple asymptote nécesssite 20000 pts, il faut etendre la mémoire (-extra-mem-top=10000000)
    % Ne marche qu'avec MikTex
    % externalize et output-dir ne fonctionnent pas bien ensemble
    % il faut donc propager le output directory dans la command ci-dessus.
    \tikzset{external/system call={pdflatex --output-directory build \tikzexternalcheckshellescape -halt-on-error -interaction=batchmode -jobname "\image" "\texsource"}}

    % Pour regenerer une figure, \tikset{external/remake next}

    % \pgfplotscreateplotcyclelist{my cycle}{%
    %     thick, solid,          every mark/.append style={solid}\\%
    % }
    \pgfplotsset{%
        compat=newest,
        height=6.5cm,
        % cycle list name=my cycle,
        every axis legend/.style={
            cells={anchor=west},
            draw=black,
        },
        every axis plot/.append style={
            mark options=solid,
            line width=1pt
        },
    }

    \usepackage{tikz}
    \usetikzlibrary{calc} % permet de réaliser des calculs dans tikz
    \usetikzlibrary{patterns} % permet de faire des patterns
    \usetikzlibrary{math} % permet de definir des variables
    \usetikzlibrary{arrows.meta} % permet de spécifier les tailles des pointes de fleches
    \tikzset{every picture/.style={execute at begin picture={
        \shorthandoff{:;!?};} % permet de prendre en compte la ponctuation française dans tikz
    }}

% % permet d'ajouter des notes en marges
% \setlength{\oddsidemargin}{25mm}
% \setlength{\evensidemargin}{25mm}
% \setlength{\textwidth}{170mm}
% \reversemarginpar
% \usepackage{todonotes}

\usepackage{fancyhdr}      % Entête et pieds de page. Doit être placé APRES geometry
    \pagestyle{fancy}    % Indique que le style de la page sera justement fancy
    \fancyfoot{} % bas de page, rien
    \fancyfoot[RO,LE]{\thepage} % tête de page, droite paire, gauche impaire, rien
    \fancyhead{}
    \fancyhead[RO]{\nouppercase{\rightmark}} % tête de page droite impaire, le titre de la section
    \fancyhead[LE]{\nouppercase{\leftmark}} %tête de page gauche paire, le titre du chapitre

    \fancypagestyle{annexe}{
    \fancyfoot{} % bas de page, rien
    \fancyfoot[RO,LE]{\thepage} % tête de page, droite paire, gauche impaire, rien
    \fancyhead[RO]{\nouppercase{\rightmark}} % tête de page droite impaire, le titre de l'annexe
    \fancyhead[LE]{Annexe} %tête de page gauche paire, rien
    }

\usepackage{multirow}
\usepackage{array}   % for \newcolumntype macro
    \newcolumntype{L}{>{\(}l<{\)}} % math-mode version of column type
    \newcolumntype{C}{>{\(}c<{\)}}
    \newcolumntype{R}{>{\(}r<{\)}}

\usepackage{tcolorbox} % Pour faire de jolie boite, un peu visible
\usepackage{lettrine} % Pour faire de jolie lettrine 
    % voir http://ctan.tetaneutral.net/macros/latex/contrib/lettrine/doc/demo.pdf

\usepackage{makecell} % Permet de mettre des \\ dans tableau grâce à un \makecell{un \\ text} et

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{pdflscape} % Pour pouvoir changer l'orientation des pages
    % avec \begin{landscape} ... 
    %%% Solution pour avoir un paysage qui pointe vers l'intérieur du livre
    \makeatletter
    \global\let\orig@begin@landscape=\landscape%
    \global\let\orig@end@landscape=\endlandscape%
    \gdef\@true{1}
    \gdef\@false{0}
    \gdef\landscape{%
        \global\let\within@landscape=\@true%
        \orig@begin@landscape%
    }%
    \gdef\endlandscape{%
        \orig@end@landscape%
        \global\let\within@landscape=\@false%
    }%
    \@ifpackageloaded{pdflscape}{%
        \gdef\pdf@landscape@rotate{\PLS@Rotate}%
    }{
        \gdef\pdf@landscape@rotate#1{}%
    }
    \let\latex@outputpage\@outputpage
    \def\@outputpage{
        \ifx\within@landscape\@true%
            \if@twoside%
                \ifodd\c@page%
                    \gdef\LS@rot{\setbox\@outputbox\vbox{%
                        \pdf@landscape@rotate{-90}%
                        \hbox{\rotatebox{90}{\hbox{\rotatebox{180}{\box\@outputbox}}}}}%
                    }%
                \else%
                    \gdef\LS@rot{\setbox\@outputbox\vbox{%
                        \pdf@landscape@rotate{+90}%
                        \hbox{\rotatebox{90}{\hbox{\rotatebox{0}{\box\@outputbox}}}}}%
                    }%
                \fi%
            \else%
                \gdef\LS@rot{\setbox\@outputbox\vbox{%
                    \pdf@landscape@rotate{+90}%
                    \hbox{\rotatebox{90}{\hbox{\rotatebox{0}{\box\@outputbox}}}}}%
                }%
            \fi%
        \fi%
        \latex@outputpage%
    }
    \makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Pas de numéro de page sur la première page des chapitres
\makeatletter
\let\ps@plain=\ps@empty
\makeatother

% Réglage fin des notes de bas de page
\FrenchFootnotes % pour les notes de bas de page à la française
\AddThinSpaceBeforeFootnotes % pour avoir une espace fine entre le mot et l'appel de note

% Pour que les pages paires sans texte (par exemple, à la fin d'un chapitre et
% avant un autre), ne contiennent ni en-tête ni pied de page (source :
% http://www.tex.ac.uk/cgi-bin/texfaq2html?label=reallyblank)
\let\origdoublepage\cleardoublepage
\newcommand{\clearemptydoublepage}{%
  \clearpage
  {\pagestyle{empty}\origdoublepage}%
}
\let\cleardoublepage\clearemptydoublepage

\setcounter{tocdepth}{1} % Sommaire n'inclus que les niveau 1 à 2 : section, sous-section

\setlength{\parindent}{0pt} % pas d'alinéa à chaque paragraphe

% Module pour formater du code
\usepackage{listings}
    \lstdefinelanguage{modern-fortran}{ % Creation d'un nouveau language
        language=[08]Fortran,
        otherkeywords={\%}, % pour les types dérivés
        deletekeywords=[1]{ IN, OUT, INOUT}, % On enlève ces mots clefs de la catégorie 1
        deletekeywords=[2]{ SIZE, TYPE, NAME, UNIT}, % de la catégorie 2
        morekeywords=[1]{}, % On ajoute ces mots clefs à la catégrories 1
        morekeywords=[2]{in,out,inout},
    }
    \lstdefinestyle{fortran}{ % Un nouveau style
        numbers=none, % pas de numéros de lignes
        language=modern-fortran, % Le language par défaut
        basicstyle={\small\ttfamily}, % Style du texte
        keywordstyle=[1]{\color{purple}}, % style des mots clefs 1
        keywordstyle=[2]{\color{red}},
        keywordstyle=[3]{\color{blue}},
        commentstyle={\color{gray}}, % style des comentaires
        stringstyle={\color{orange}}, % style des chaines de caratères
        columns=fixed, % rendue du texte en monospace, espaces compris
        basewidth={.48em}, % largeur d'un caractère
        showstringspaces=false, % Ne pas accentuer les espaces dans les chaines de caractères
    }
    \lstdefinestyle{shell}{ % Un nouveau style
        numbers=none, % pas de numéros de lignes
        language=bash, % Le language par défaut
        keywords=,
        basicstyle={\small\ttfamily}, % Style du texte
        columns=fixed, % rendue du texte en monospace, espaces compris
        basewidth={.48em}, % largeur d'un caractère
        showstringspaces=false, % Ne pas accentuer les espaces dans les chaines de caractères
    }
    \lstset{ % paramètres par défaut
        style=fortran, % style
        literate=% lstlistings ne comprend pas les accents utf8 é à ...
        {é}{{\'e}}1% Il faut donc les convertir en macros tex et indiquer la taille en caractères du rendu
        {è}{{\`e}}1%
        {ê}{{\^e}}1%
        {à}{{\`a}}1%
        {à }{{\`a{ }}}2%
        {â}{{\^a}}1%
        {ô}{{\^o}}1%
        {î}{{\^i}}1%
    }

%redefinition
\renewcommand{\frac}[2]{\dfrac{#1}{#2}} % Toujours de grandes fractions
\renewcommand{\tilde}[1]{\overset{\thicksim}{#1}} % Toujours un grand tilde
\newcommand{\tagit}{\addtocounter{equation}{1}\tag{\theequation}}
\newcommand{\ds}{\displaystyle}

\newcommand{\secref}[1]{(\S \ref{#1})}

\newcommand{\CSU}[2][{}]{\ensuremath{\operatorname{CSU}_{\operatorname{#2}}^{#1}}}

% Notation produit vectoriel
\newcommand{\pvect}{\wedge}

% Notation vectorielle
\newcommand{\comp}[1]{{\underline{#1}}} % {\overset{\rightarrow{}}{#1}}

%\newcommand{\vect}[1]{\vec{#1}}
\newcommand{\vect}[1]{{\overset{\rightarrow}{#1}}}

% Notation matricielle
\newcommand{\mat}[1]{\mathbf{#1}}

% Le conjugé
% \newcommand{\conj}[1]{{{#1}^*}}
\newcommand{\conj}[1]{{\overline{#1}}}

\newcommand{\ps}[2]{\left<{#1},{#2}\right>}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

% Quelques matrices qui reviennent
\newcommand{\mI}{\mat{I}}
\newcommand{\mZ}{\mat{Z}}
\newcommand{\mA}{\mat{A}}
\newcommand{\mB}{\mat{B}}
\newcommand{\mPP}{\mat{P}}
\newcommand{\mC}{\mat{C}}
\newcommand{\mM}{\mat{M}}
\newcommand{\mJ}{\mat{J}}
\newcommand{\mj}{\mat{j}}
\newcommand{\mH}{\mat{H}}
\newcommand{\mh}{\mat{h}}
\newcommand{\mN}{\mat{N}}
\newcommand{\mMt}{\mat{\tilde{M}}}
\newcommand{\mNt}{\mat{\tilde{N}}}
\newcommand{\mLD}{\mat{L_D}}
\newcommand{\mLR}{\mat{L_R}}
\newcommand{\mL}{\mat{L}}
\newcommand{\mR}{\mat{R}}
\newcommand{\mT}{\mat{T}}
\newcommand{\mF}{\mat{F}}
%\newcommand{\mPt}{\mat{\tilde{P}}}
%\newcommand{\mP}{\mat{P}}
\newcommand{\mS}{\mat{S}}
\newcommand{\mSt}{\mat{\tilde{S}}}

% Matrices de Gramm de la base #1 vers #2
\newcommand{\mG}[2]{\mat{G}^{#1#2}}

% Matrices de passage de la base #1 vers #2 projeté sur #3
\newcommand{\mP}[3]{{\overset{#3}{\underset{#1 \rightarrow #2}{\mat{P}}}}}

% Opérateur pseudo diff
\newcommand{\Op}[2]{{\operatorname{Op}\left(#1\right)\left(#2\right)}}

\newcommand{\w}{\omega}

%mathematical symbol
\newcommand{\RR}{\mathbb R}
\newcommand{\CC}{\mathbb C}
\newcommand{\NN}{\mathbb N}
\newcommand{\ZZ}{\mathbb Z}
\newcommand{\eps}{\epsilon}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\OO}{\Omega}

\newcommand{\ddp}[3][{}]{\dfrac{\mathrm{d}^{#1}#3}{{\mathrm{d}#2}^{#1}}}
\newcommand{\ddr}[3][{}]{\dfrac{\partial^{#1} #3}{{\partial #2}^{#1}}}

%Operator
\newcommand{\Sobup}[1][{}]{\mathrm{H}^\mathrm{#1}}
\newcommand{\Sobdw}[1][{}]{\mathrm{H}_\mathrm{#1}}
\newcommand{\Sobolev}[1][{}]{\Sobup{#1}}
\newcommand{\Hgrad}{\Sobdw[grad]}
\newcommand{\Hrot}{\Sobdw[rot]}
\newcommand{\Hdiv}{\Sobdw[div]}
\newcommand{\Hess}{\operatorname{Hess}}
\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}

\newcommand{\diag}[2]{\operatorname{diag}\left(#1,#2\right)}

\newcommand{\sign}[1]{{\operatorname{sign}\left(#1\right)}}
\newcommand{\argmin}[1]{{\underset{#1}{\operatorname{argmin}}}}
\newcommand{\Ker}{\operatorname{Ker}}
\newcommand{\Img}{\operatorname{Img}}
\newcommand{\Vect}[1]{\operatorname{Vect}\left\lbrace#1\right\rbrace}

\newcommand{\Tr}{\operatorname{T_R}}
\newcommand{\oI}{{\mathcal{I}}}
\newcommand{\LD}{{\mathcal{L}_D}}
\newcommand{\LL}{\mathcal{L}}
\newcommand{\LR}{{\mathcal{L}_R}}

\newcommand{\EFIE}{\operatorname{EFIE}}
\newcommand{\MFIE}{\operatorname{MFIE}}
\newcommand{\CFIE}{\operatorname{CFIE}}

%Maxwell notations
\newcommand{\vE}{\vect{E}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\vH}{\vect{\cH}}
\newcommand{\vn}{\vect{n}}
\newcommand{\vx}{\vect{x}}
\newcommand{\vz}{\vect{z}}
\newcommand{\vy}{\vect{y}}
\newcommand{\vk}{\vect{k}}
\newcommand{\vJ}{\vect{J}}
\newcommand{\vK}{\vect{K}}
\newcommand{\vM}{\vect{M}}
\newcommand{\vA}{\vect{A}}
\newcommand{\vu}{\vect{u}}
\newcommand{\vv}{\vect{v}}
\newcommand{\vw}{\vect{w}}

%differential operator
\newcommand{\vgrad}{\vect{\nabla}}
\newcommand{\vdiv}{\vect{\nabla}\cdot}
\newcommand{\vrot}{\vect{\nabla}\pvect}
\newcommand{\vhess}{\vect{\Hess}}

\newcommand{\tgrad}{{\vect{\operatorname{grad}}}}
\newcommand{\trot}{{\vect{\operatorname{rot}}}}
\newcommand{\tdiv}{{\operatorname{div}}}

\newcommand{\vgrads}{\vect{\nabla_s}}
\newcommand{\vdivs}{\vect{\nabla_s} \cdot}
\newcommand{\vrots}{\vect{\nabla_s} \pvect}
\newcommand{\rots}{{\nabla_s} \pvect}
\newcommand{\vhesss}{\vect{\Hess_s}}

\newcommand{\mhess}{\mat{\Hess}}
\newcommand{\mhesss}{\mat{\Hess}_s}

\newcommand{\tgrads}{{\vect{\operatorname{grad}}_s}}
\newcommand{\trots}{{{\operatorname{rot}}_s}}
\newcommand{\tvrots}{{\vect{\operatorname{rot}}_s}}
\newcommand{\tdivs}{{\operatorname{div}_s}}

\newcommand{\lapl}{\Delta}
\newcommand{\lapls}{\Delta_s}
\newcommand{\vlapl}{\vect{\Delta}}
\newcommand{\vlapls}{\vect{\Delta_s}}

% helmotlz
\newcommand{\rtp}{r,\theta,\phi}
\newcommand{\tp}{\theta,\phi}

\newcommand{\PP}{\mathbb{P}}
\newcommand{\Pmn}{\PP^m_n}

% cioe
\newcommand{\ov}[1]{\overline{#1}}

\newcommand{\x}{{x}}
\newcommand{\y}{{y}}
\newcommand{\z}{{z}}

\newcommand{\kO}{\mathbf{k_0}}
\newcommand{\etaO}{\boldsymbol{\eta_0}}
\newcommand{\muO}{\boldsymbol{\mu_0}}
\newcommand{\epsO}{\boldsymbol{\eps_0}}
\newcommand{\nuO}{\boldsymbol{\nu_0}}

%
\newcommand{\peps}{{\epsilon}}
\newcommand{\pmu}{{\mu}}

\newcommand{\phii}{\vect{\phi_i}}
\newcommand{\pii}{\vect{p_i}}
\newcommand{\phin}{\vect{\phi_n}}
\newcommand{\phim}{\vect{\phi_m}}
\newcommand{\pn}{\vect{p_n}}
\newcommand{\ppm}{\vect{p_m}}
\newcommand{\phip}{\vect{\phi_p}}
\newcommand{\phiq}{\vect{\phi_q}}
\newcommand{\pj}{\vect{p_j}}
\newcommand{\qj}{\vect{q_j}}
\newcommand{\qi}{\vect{q_i}}
\newcommand{\nuj}{\vect{\nu_j}}
\newcommand{\uj}{\vect{u_j}}
\newcommand{\phij}{\vect{\phi_j}}

%% avec référence dans la table des matières et les bons en-têtes
%% il sert pour l'introduction, la page de notations, etc
\newcommand{\chapterstar}[1]{%
  \chapter*{#1}%
  \addcontentsline{toc}{chapter}{#1}%
  %\markboth{#1}{#1}
  }
\newcommand{\sectionstar}[1]{%
  \section*{#1}%
  \addcontentsline{toc}{section}{#1}%
  %\markboth{#1}{#1}
  }

\newcommand{\Mmn}[1][{}]{\vect{M_{m,n}^{#1}}}
\newcommand{\Nmn}[1][{}]{\vect{N_{m,n}^{#1}}}
\newcommand{\Umn}[1][{}]{\vect{U_{m,n}^{#1}}}

\newcommand{\NaN}{\operatorname{NaN}}
\newcommand{\e}[1]{\mathrm{e}{#1}}

\newcommand{\fonction}[5]{
  \begin{aligned}
  &#1: & #2 &\rightarrow #3
  \\
  & & #4 & \mapsto #5
  \end{aligned}
}

\newenvironment{coefftable}[1]{%
  \begin{tabular}{lc}
  \multicolumn{2}{c}{#1}\\
  \hline
  \hline
}{
   \end{tabular}
}

% macro with argument filename
% \newcommand{\coefftable}[1]{%
%   \def\icoefffile{#1}\icoefftable
% }
\newcommand{\tablecoeff}[3][1]{%
 \begin{minipage}[t]{#1\textwidth}
    \centering
    \vspace{0pt}
    \begin{coefftable}{#2}
      \input{#3}
    \end{coefftable}
  \end{minipage}
}

  \renewcommand{\glstextformat}[1]{\textcolor{black}{#1}}
  \renewcommand{\glossarysection}[2][1]{%
    \def\theglstoctitle{#2}%
    \par\noindent
    {\section*{\theglstoctitle}}
    %{\addcontentsline{toc}{section}{\theglstoctitle}}%
  }
  
  % create :
  % \newglossary{glossary}{glossaryls}{glossarylo}{text}
  
  \newglossary{acr}{acrls}{acrlo}{Acronymes}
  \newglossary{mat}{matls}{matlo}{Notations Mathématiques}
  \newglossary{phy}{phyls}{phylo}{Notations Physiques}
  \newglossary{ope}{opels}{opelo}{Opérateurs}
  
  \makeglossaries
  
  % create :
  % \newglossaryentry{glossary-shortlabel}{
  %  type={glossary},
  %  sort={sort},
  %  name={\ensuremath{text}},
  %  description={description},
  % }
  % use :
  % \gls{glossary-shortlabel}
  
  \newglossaryentry{mat-om}{
    type={mat},
    sort={om},
    name={\ensuremath{\OO}},
    description={domaine, objet},
  }
  \newglossaryentry{mat-q}{
    type={mat},
    sort={q},
    name={\ensuremath{Q}},
    description={Flux du vecteur de Poynting a travers la surface \(\Gamma\)\\& \(Q = \int_\Gamma \vn \pvect \vH \cdot \conj{\vE}\)},
  }
  \newglossaryentry{mat-ga}{
    type={mat},
    sort={ga},
    name={\ensuremath{\Gamma}},
    description={frontière de \(\OO\)},
  }
  \newglossaryentry{mat-vx}{
    type={mat},
    sort={vx},
    name={\(\vec{x}\)},
    description={point de \(\OO\)},
  }
  \newglossaryentry{mat-vn}{
    type={mat},
    sort={vn},
    name={\ensuremath{\vec{n}}},
    description={normale unitaire sortante de \(\OO\)},
  }
  \newglossaryentry{mat-boulexr}{
    type={mat},
    sort={boulexr},
    name={\ensuremath{B(\vec x,R)}},
    description={boule de centre \( x\) et de rayon R},
  }
  \newglossaryentry{mat-spherexr}{
    type={mat},
    sort={spherexr},
    name={\ensuremath{S(\vec x,R)}},
    description={sphère de centre \( x\) et de rayon R},
  }
  \newglossaryentry{mat-hi}{
    type={mat},
    sort={hi},
    name={\ensuremath{H^i(\OO)}},
    description={espace de Sobolev d'ordre \(i\)},
  }
  \newglossaryentry{mat-xcart}{
    type={mat},
    sort={xcart},
    name={\ensuremath{(x_1,x_2,x_3)}},
    description={coordonnées cartésiennes de \(x\)},
  }
  \newglossaryentry{mat-xsphe}{
    type={mat},
    sort={xsphe},
    name={\ensuremath{(\rtp)}},
    description={coordonnées sphérique de \(x\)},
  }
  \newglossaryentry{mat-pn}{
    type={mat},
    sort={pn},
    name={\ensuremath{P_n(x)}},
    description={polynôme de Legendre de degré \(n\)},
  }
  \newglossaryentry{mat-pmn}{
    type={mat},
    sort={pmn},
    name={\ensuremath{P^m_n(x)}},
    description={fonction de Legendre d'ordre \(m\) et de degré \(n\)},
  }
  \newglossaryentry{mat-jn}{
    type={mat},
    sort={bjn},
    name={\ensuremath{j_n(z)}},
    description={fonction de Bessel du 1er ordre de degré \(n\)},
  }
  \newglossaryentry{mat-hn}{
    type={mat},
    sort={bhn},
    name={\ensuremath{h_n(z)}},
    description={fonction de Hankel du 2eme type de degré \(n\)},
  }
  \newglossaryentry{mat-ymn}{
    type={mat},
    sort={bymn},
    name={\ensuremath{Y_{m,n}}},
    description={harmonique sphérique d'ordre \(m\) et de degré \(n\)},
  }
  \newglossaryentry{mat-tild}{
    type={mat},
    sort={tild},
    name={tilde},
    description={\(\tilde{f}(z) = \ddp{z}{(zf(z))}\)},
  }
  \newglossaryentry{mat-four}{
    type={mat},
    sort={four},
    name={\ensuremath{\hat u}},
    description={transformée de Fourrier de \(u\)},
  }
  \newglossaryentry{mat-matimp}{
    type={mat},
    sort={matimp},
    name={\ensuremath{\mZ}},
    description={Symbole de l'opérateur d'impédance, matrice d'impédance},
  }
  \newglossaryentry{mat-conj}{
    type={mat},
    sort={cconj},
    name={\ensuremath{\conj{z}}},
    description={complexe conjugué de \(z\)},
  }
  \newglossaryentry{mat-real}{
    type={mat},
    sort={creal},
    name={\ensuremath{z'}},
    description={partie réelle},
  }
  \newglossaryentry{mat-imag}{
    type={mat},
    sort={cimag},
    name={\ensuremath{z''}},
    description={partie imaginaire},
  }
  \newglossaryentry{mat-sum}{
    type={mat},
    sort={sum},
    name={\ensuremath{\ov x}},
    description={\(:= \sum_n x_n\). Somme des termes d'une suite.},
  }
  \newglossaryentry{mat-gmn}{
    type={mat},
    sort={gmn},
    name={\ensuremath{\gamma_{m,n}}},
    description={\(:=\frac{4\pi}{2n+1}n(n+1)\frac{(n+m)!}{(n-m)!}\)},
  }
  \newglossaryentry{mat-vec-comp}{
    type={mat},
    sort={vec-comp},
    name={\ensuremath{[x,y,z]^t}},
    description={Un veceur de composante \(x,y,z\).},
  }
  \newglossaryentry{mat-vec-abstract}{
    type={mat},
    sort={vec-abstract},
    name={\ensuremath{\vec{x}}},
    description={Un veceur.},
  }
  \newglossaryentry{mat-mat-abstract}{
    type={mat},
    sort={mat-abstract},
    name={\ensuremath{\mat{M}}},
    description={Une matrice. \(\begin{bmatrix} a & b \\ c & d \end{bmatrix}\)},
  }
  
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  
  \newglossaryentry{ope-pv}{
    type={ope},
    sort={pv},
    name={\ensuremath{\pvect}},
    description={produit vecoriel},
  }
  \newglossaryentry{ope-grad}{
    type={ope},
    sort={grad},
    name={\ensuremath{\vec{\nabla}}},
    description={gradient},
  }
  \newglossaryentry{ope-grads}{
    type={ope},
    sort={grads},
    name={\ensuremath{\vec{\nabla}_s}},
    description={gradient surfacique : \(\vec{\nabla}_s u:= \vec{\nabla} u - \vec{n} ( \vec{n} \cdot \vec{\nabla} u )\)},
  }
  \newglossaryentry{ope-div}{
    type={ope},
    sort={div},
    name={\ensuremath{\vec{\nabla}\cdot}},
    description={divergent},
  }
  \newglossaryentry{ope-divs}{
    type={ope},
    sort={divs},
    name={\ensuremath{\vec{\nabla}_s\cdot}},
    description={divergent surfacique},
  }
  \newglossaryentry{ope-rot}{
    type={ope},
    sort={rot},
    name={\ensuremath{\vec{\nabla}\pvect}},
    description={rotationnel},
  }
  \newglossaryentry{ope-rots}{
    type={ope},
    sort={rots},
    name={\ensuremath{\vec{\nabla}_s\pvect}},
    description={rotationnel surfacique},
  }
  \newglossaryentry{ope-laps}{
    type={ope},
    sort={laps},
    name={\ensuremath{\Delta}},
    description={laplacien},
  }
  \newglossaryentry{ope-hess}{
    type={ope},
    sort={hess},
    name={\ensuremath{\Hess}},
    description={hessienne},
  }
  \newglossaryentry{ope-LD}{
    type={ope},
    sort={hodge-LD},
    name={\ensuremath{\LD}},
    description={\( \int_\Gamma \LD( \vec{u})(x)\cdot\vec{v}(x)\dd{\Gamma}(x) := - \int_\Gamma \vdivs  \vec{u}(x) \vdivs  \vec{v}(x) \dd{\Gamma}(x)\)},
  }
  \newglossaryentry{ope-LR}{
    type={ope},
    sort={hodge-LR},
    name={\ensuremath{\LR}},
    description={\( \int_\Gamma \LR( \vec{u})(x)\cdot\vec{v}(x)\dd{\Gamma}(x) :=  \int_\Gamma \left( \vn \cdot \vrots  \vec{u}(x) \right)\left(\vn \cdot \vrots  \vec{v}(x) \right)\dd{\Gamma}(x)\)},
  }
  \newglossaryentry{ope-L}{
    type={ope},
    sort={hodge-L},
    name={\ensuremath{\LL}},
    description={\( = \LD - \LR\)},
  }
  \newglossaryentry{ope-real}{
    type={ope},
    sort={creal},
    name={\ensuremath{\Re(z)}},
    description={partie réelle de \(z\)},
  }
  \newglossaryentry{ope-imag}{
    type={ope},
    sort={cimag},
    name={\ensuremath{\Im(z)}},
    description={partie imaginaire de \(z\)},
  }
  \newglossaryentry{ope-trans}{
    type={ope},
    sort={trans},
    name={\ensuremath{{\mA}^t}},
    description={transposée de A},
  }
  \newglossaryentry{ope-imp}{
    type={ope},
    sort={imp},
    name={\ensuremath{\Op{\sigma}{f}}},
    description={Opérateur pseudo-différentiel associé au symbole \(\sigma\) appliqué à \(f\)},
  }
  \newglossaryentry{ope-saut}{
    type=ope,
    sort=saut,
    name={\ensuremath{[\hat U]_{s}}},
    description={Saut de U à travers la surface \(s\): \(U(s+) - U(s-)\).},
  }
  
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  
  \newglossaryentry{phy-e}{
    type={phy},
    sort={E},
    name={\ensuremath{\vec{E}}},
    description={champ électrique \([V.m^{-1}]\)},
  }
  \newglossaryentry{phy-h}{
    type={phy},
    sort={Ha},
    name={\ensuremath{\vec{H}}},
    description={champ magnétique \([A.m^{-1}]\)},
  }
  \newglossaryentry{phy-h2}{
    type={phy},
    sort={Hb},
    name={\ensuremath{\vec{\mathcal{H}}}},
    description={excitation magnétique \(\vec{\mathcal{H}} = \gls{phy-eta}_0 \gls{phy-h}\) \([V.m^{-1}]\)},
  }
  \newglossaryentry{phy-f}{
    type={phy},
    sort={f},
    name={\ensuremath{f}},
    description={fréquence [Hz]},
  }
  \newglossaryentry{phy-c}{
    type={phy},
    sort={c},
    name={\ensuremath{c}},
    description={célérité de la lumière \(c=2.99792458\,10^{8}\) \([m.s^{-1}]\)},
  }
  \newglossaryentry{phy-d}{
    type={phy},
    sort={d},
    name={\ensuremath{d}},
    description={épaisseur d'une couche de matériau \([m]\)},
  }
  \newglossaryentry{phy-w}{
    type={phy},
    sort={omega},
    name={\ensuremath{\w}},
    description={pulsation d'une onde \([s^{-1}]\)},
  }
  \newglossaryentry{phy-mu0}{
    type={phy},
    sort={mu_zero},
    name={\ensuremath{\mu_0}},
    description={perméabilité du vide \([H.m^{-1}]\)},
  }
  \newglossaryentry{phy-eps0}{
    type={phy},
    sort={eps_zero},
    name={\ensuremath{\eps_0}},
    description={permittivité du vide \([F.m^{-1}]\)},
  }
  \newglossaryentry{phy-mu}{
    type={phy},
    sort={mu},
    name={\ensuremath{\mu}},
    description={perméabilité relative complexe [1]},
  }
  \newglossaryentry{phy-eps}{
    type={phy},
    sort={eps},
    name={\ensuremath{\eps}},
    description={permittivité relative complexe [1]},
  }
  \newglossaryentry{phy-eta}{
    type={phy},
    sort={eta},
    name={\ensuremath{\eta}},
    description={impédance \(\eta=\sqrt{\gls{phy-mu}\slash\gls{phy-eps}}\)  [Ohm]},
  }
  \newglossaryentry{phy-eta0}{
    type={phy},
    sort={eta_zero},
    name={\ensuremath{\eta_0}},
    description={impédance du vide \(\eta_0=120 \pi\) [Ohm]},
  }
  \newglossaryentry{phy-nu}{
    type={phy},
    sort={nu},
    name={\ensuremath{\nu}},
    description={indice relatif du matériau \(\nu = \sqrt{\mu_r\eps_r}\) [1]},
  }
  \newglossaryentry{phy-k0}{
    type={phy},
    sort={kzero},
    name={\ensuremath{k_0}},
    description={nombre d'onde dans le vide \(k_0=\frac{2\pi \gls{phy-f}}{\gls{phy-c}}\) \([m^{-1}]\)},
  }
  \newglossaryentry{phy-k}{
    type={phy},
    sort={k},
    name={\ensuremath{k}},
    description={nombre d'onde dans le matériau \(k=\gls{phy-k0}\gls{phy-nu}\) \([m^{-1}]\)},
  }
  \newglossaryentry{phy-Mmn}{
    type={phy},
    sort={Mmn},
    name={\ensuremath{\vec{M_{m,n}}}},
    description={vecteur harmonique sphérique d'ordre \(m\) \\ & et de degré \(n\)},
  }
  \newglossaryentry{phy-Nmn}{
    type={phy},
    sort={Nmn},
    name={\ensuremath{\vec{N_{m,n}}}},
    description={vecteur harmonique sphérique d'ordre \(m\) \\ & et de degré \(n\)},
  }
  \newglossaryentry{phy-J}{
    type={phy},
    sort={J},
    name={\ensuremath{\vec{J}}},
    description={trace tangentielle sur \gls{mat-ga} de l'excitation \\ & magnétique \(\gls{phy-J} = \gls{mat-vn} \times \gls{phy-h2}\) \([A.m^{-2}]\)},
  }
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  \newglossaryentry{acr-pml}{
    type={acr},
    name={PML},
    plural={PML},
    description={perfectly matched layer},
    descriptionplural={perfectly matched layers},
    first={\glsentrydesc{acr-pml} (\glsentrytext{acr-pml})},
    firstplural={\glsentrydescplural{acr-pml} (\glsentryplural{acr-pml})},
  }
  \newglossaryentry{acr-cla}{
    type={acr},
    name={CLA},
    plural={CLA},
    description={condition limite absorbante},
    descriptionplural={conditions limite absorbantes},
    first={\glsentrydesc{acr-cla} (\glsentrytext{acr-cla})},
    firstplural={\glsentrydescplural{acr-cla} (\glsentryplural{acr-cla})},
  }
  \newglossaryentry{acr-csu}{
    type={acr},
    name={CSU},
    description={condition suffisante d'unicité},
    plural={CSU},
    descriptionplural={conditions suffisantes d'unicité},
    first={\glsentrydesc{acr-csu} (\glsentrytext{acr-csu})},
    firstplural={\glsentrydescplural{acr-csu} (\glsentryplural{acr-csu})},
  }
  \newglossaryentry{acr-cgu}{
    type={acr},
    name={CSUG},
    description={condition suffisante d'unicité générale},
    first={\glsentrydesc{acr-cgu} (\glsentrytext{acr-cgu})},
  }
  \newglossaryentry{acr-ser}{
    type={acr},
    name={SER},
    description={surface équivalente radar},
    first={\glsentrydesc{acr-ser} (\glsentrytext{acr-ser})},
  }
  \newglossaryentry{acr-ci}{
    type={acr},
    name={CI},
    description={condition d'impédance},
    plural={CI},
    descriptionplural={conditions d'impédance},
    first={\glsentrydesc{acr-ci} (\glsentrytext{acr-ci})},
    firstplural={\glsentrydescplural{acr-ci} (\glsentryplural{acr-ci})},
  }
  \newglossaryentry{acr-cioe}{
    type={acr},
    name={CIOE},
    description={condition d'impédance d'ordre élevé},
    first={\glsentrydesc{acr-cioe} (\glsentrytext{acr-cioe})},
    plural={CIOE},
    descriptionplural={conditions d'impédance d'ordre élevé},
    firstplural={\glsentrydescplural{acr-cioe} (\glsentryplural{acr-cioe})},
  }
  \newglossaryentry{acr-pec}{
    type={acr},
    name={PEC},
    description={perfect electric conductor},
    plural={PEC},
    descriptionplural={perfect electric conductors},
    first={\glsentrydesc{acr-pec} (\glsentrytext{acr-pec})},
    firstplural={\glsentrydescplural{acr-pec} (\glsentryplural{acr-pec})},
  }
  \newglossaryentry{acr-cp}{
    type={acr},
    name={CP},
    description={conducteur parfait},
    plural={CP},
    descriptionplural={conducteurs parfait},
    first={\glsentrydesc{acr-cp} (\glsentrytext{acr-cp})},
    firstplural={\glsentrydescplural{acr-cp} (\glsentryplural{acr-cp})},
  }
  \newglossaryentry{acr-cep}{
    type={acr},
    name={CEP},
    description={conducteur électriquement parfait},
    plural={CEP},
    descriptionplural={conducteurs électriquement parfait},
    first={\glsentrydesc{acr-cep} (\glsentrytext{acr-cep})},
    firstplural={\glsentrydescplural{acr-cep} (\glsentryplural{acr-cep})},
  }
  \newglossaryentry{acr-cmp}{
    type={acr},
    name={CMP},
    description={conducteur magnétiquement parfait},
    plural={CMP},
    descriptionplural={conducteurs magnétiquement parfait},
    first={\glsentrydesc{acr-cmp} (\glsentrytext{acr-cmp})},
    firstplural={\glsentrydescplural{acr-cmp} (\glsentryplural{acr-cmp})},
  }
  \newglossaryentry{acr-edo}{
    type={acr},
    name={EDO},
    description={équation différentielle ordinaire},
    plural={EDO},
    descriptionplural={équations différentielles ordinaire},
    first={\glsentrydesc{acr-edo} (\glsentrytext{acr-edo})},
    firstplural={\glsentrydescplural{acr-edo} (\glsentryplural{acr-edo})},
  }
  \newglossaryentry{acr-edp}{
    type={acr},
    name={EDP},
    description={équation aux dérivées partielles},
    plural={EDP},
    descriptionplural={équations aux dérivées partielles},
    first={\glsentrydesc{acr-edp} (\glsentrytext{acr-edp})},
    firstplural={\glsentrydescplural{acr-edp} (\glsentryplural{acr-edp})},
  }
  \newglossaryentry{acr-te}{
    type={acr},
    name={TE},
    description={transverse électrique},
    plural={TE},
    descriptionplural={transverse électrique},
    first={\glsentrydesc{acr-te} (\glsentrytext{acr-te})},
    firstplural={\glsentrydescplural{acr-te} (\glsentryplural{acr-te})},
  }
  \newglossaryentry{acr-tm}{
    type={acr},
    name={TM},
    description={transverse magnétique},
    plural={TM},
    descriptionplural={transverse électrique},
    first={\glsentrydesc{acr-tm} (\glsentrytext{acr-tm})},
    firstplural={\glsentrydescplural{acr-tm} (\glsentryplural{acr-tm})},
  }
  \newglossaryentry{acr-cr}{
    type={acr},
    name={CR},
    description={coefficient de réflexion},
    plural={CR},
    descriptionplural={coefficients de réflexion},
    first={\glsentrydesc{acr-cr} (\glsentrytext{acr-cr})},
    firstplural={\glsentrydescplural{acr-cr} (\glsentryplural{acr-cr})},
  }
  \newglossaryentry{acr-ei}{
    type={acr},
    name={EI},
    plural={EI},
    description={équation intégrale},
    descriptionplural={équations intégrales},
    first={\glsentrydesc{acr-ei} (\glsentrytext{acr-ei})},
    firstplural={\glsentrydescplural{acr-ei} (\glsentryplural{acr-ei})},
  }
  \newglossaryentry{acr-efie}{
    type={acr},
    name={EFIE},
    description={electric field integral equation},
    first={\glsentrydesc{acr-efie} (\glsentrytext{acr-efie})},
  }
  \newglossaryentry{acr-mfie}{
    type={acr},
    name={MFIE},
    description={magnetic field integral equation},
    first={\glsentrydesc{acr-mfie} (\glsentrytext{acr-mfie})},
  }
  \newglossaryentry{acr-sqp}{
    type={acr},
    name={SQP},
    description={sequential quadratic programming},
    first={\glsentrydesc{acr-sqp} (\glsentrytext{acr-sqp})},
  }

% Ensemble de commande et de module pour ecrire/corriger plus facilement la these

% Pour chaque \newcommand{cmd} présent ici, un \newcommand{cmd}{} doit être present dans final

%\usepackage{draftwatermark}
%    \SetWatermarkText{BROUILLON} % Ecrire Brouillon en traversdes pages
%    \SetWatermarkScale{1}

% Creation de boite REM, qui apparaissent dans les signets
\newcounter{REM}
\newenvironment{REM}[1][\theREM]
    {%
        \stepcounter{REM}
        \hypertarget{REM#1}{}%
        \pdfbookmark[0]{REM \theREM}{REM#1}
        \begin{tcolorbox}[%
                title={Remarque \theREM},%
                colback=red!30!white,%
                colframe=red!75!black,%
            ]
    }
    {
        \end{tcolorbox}%
        %
    }%

\newcounter{REP}
\newenvironment{REP}[1][\theREM]
    {%
        \stepcounter{REP}
        \hypertarget{REP\theREP}{}%
        \pdfbookmark[1]{REP #1}{REP\theREP}%
        \begin{tcolorbox}[%
                title={Réponse #1},%
                colback=green!30!white,%
                colframe=green!35!black,%
            ]
    }
    {
        \end{tcolorbox}%
    }%

% Affiche devant chaque ligne en mode texte, le numéro de la ligne pour le corriger plus efficacement
\usepackage{lineno}
    \linenumbers

\geometry{
    top    = 2.5cm,%
    bottom = 2.5cm,%
    inner  = 1.5cm,% On décale pour avoir une marge plus grande pour annoter
    outer  = 4.5cm%
    }
% No show frame when using externalisation for plots
\ifcsname tikzexternalrealjob\endcsname
\else
\geometry{
   showframe, % Afficher les marges pour voir ce qui dépasse
}
\fi


    \begin{document}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \frontmatter
    \newpage
    \chapterstar{Acronymes et notations}
    % \begin{REM}
    %     Remplir l'index lorsque le manuscrit sera bien avancé
    % \end{REM}
    \setlength{\glsdescwidth}{\textwidth}
    \thispagestyle{empty}
    % \glsaddallunused
    \printglossaries
    \thispagestyle{empty}
    \mainmatter

% @Olivier: Décommente les 1237 lignes ci dessus


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Contexte mathématique global}

\label{sec:context_math}
\minitoc
\newpage

On s’intéresse à la propagation des ondes électromagnétiques à l'extérieur d'un objet fermé borné et convexe et régulier, sans sources. 
Les champs associés sont solutions des équations de Maxwell harmoniques, la convention dans toute la thèse étant en \(e^{i\w t}\). 

Soit \(\gls{mat-ga}=\partial\overline{\gls{mat-om}}\) la frontière de \(\OO\), on décompose donc tout l'espace entre l'intérieur et l'extérieur, soit 
\[
\RR^3 = \overline{\OO}\cup{\OO}^c.
\]
On définit en tout point de \(\Gamma\), supposée régulière, \(\gls{mat-vn}\) la normale unitaire sortante à \(\OO\).
Dans \(\OO^c\) on définit \(\gls{phy-k0}=\gls{phy-w} / \gls{phy-c} \in \RR_+^*\), le nombre d'onde dans le vide, où \gls{phy-c} 
est la célérité d'une onde dans le vide.
Dans \(\OO\), on a \(k(\vx)=k_0\sqrt{\gls{phy-eps}(\vx)\gls{phy-mu}(\vx)}\).

% Soit \((\vE,\vH)\) dans \((\Hrot(\OO^c)) \times (\Hrot(\OO^c))\) tels que:

Nous utilisons les équations de Maxwell-Helmholtz où les inconnues sont le champ électrique \gls{phy-e} et l'induction magnétique \gls{phy-h2} dans le vide, elles se déduisent du système d'équations de Maxwell (voir annexe \ref{sec:annex:maxwell_equation}). 

Soit \((\gls{phy-e},\gls{phy-h2})\) dans \((\mathcal{C}^\infty(\RR^3)\cap\Hrot(\RR^3))^3\) tels que
\begin{align}
\left\lbrace
\begin{matrix}
    \vrot \vE(\vx) + i k(\vx) \vH(\vx) &= 0
    \\
    \vrot \vH(\vx) - i k(\vx) \vE(\vx) &= 0
\end{matrix}
\right. && \text{dans \(\OO\cup\OO^c\).}
\label{eq:unicite:maxwell_ext}
\end{align}

De plus, les conditions limites considérés sont celle de Silver-Müller à l'infini (voir \cite[eq (5.2.24), p.~183]{nedelec_acoustic_2001}), et de saut à l'interface de \(\Gamma\).

\section{Equations de Maxwell à l'intérieur et à l'extérieur de l'objet}

    \subsection{Etude de l'unicité des solutions du problème intérieur}

        \begin{thm}
            Si \(\w^2\eps\mu\) n'est pas une valeur propre du Laplacien vectoriel, l'unique solution \(\vE,\vH\) de \eqref{eq:unicite:maxwell_int} avec condition aux limites de Dirichlet \(n\wedge \vE_{|\Gamma} = 0\),  est \((0,0)\).
            Si \(\w^2\eps\mu\) est une valeur propre du Laplacien vectoriel, \eqref{eq:unicite:maxwell_int} avec conditions aux limites de Dirichlet \(\vE_{|\Gamma} = 0\) a pour solution tous les vecteurs propres de l'opérateur \(A\) introduit par \cite[eq.~(133), p.~58]{cessenat_mathematical_1996}.
        \end{thm}
        La preuve s'appuie notemment sur l'alternative de Fredholm, voir \cite[Théorème~8, p.~111]{cessenat_mathematical_1996}.

    \subsection{Etude de l'unicité des solutions du problème extérieur: Lemme de Rellich}

        On définit en tout point de \(\Gamma\) la trace tangentielle de \(\vH\) que l'on note \(\vJ = \vn_\Gamma \pvect \vH\).
        \begin{prop}[Une \glsentrydesc{acr-csu}]~\\
        Si l'on suppose que
        \begin{equation}
            \label{eq:unicite:form_var:cgu}
            \Re\left(\int_\Gamma \vJ(\vx) \cdot \conj{\vE_t}(\vx) \dd{\Gamma(\vx)}\right) \ge 0,
        \end{equation}
        alors le système \eqref{eq:unicite:maxwell_ext} muni de la condition aux limites \eqref{eq:unicite:TR} admet \(\vE=\vH=0\) comme unique solution.
        \end{prop}
    
    \begin{proof}
        Pour démontrer cela, on utilise le lemme de Rellich, énoncé dans \cite[p.~74]{cessenat_mathematical_1996}:
        \begin{lemme}[Lemme de Rellich]
        Soit \(\OO^c\) un domaine connexe, complément d'un domaine borné, et soit \(u\) satisfaisant
        \begin{subequations}
            \begin{align}
            \Delta u + k^2 u = 0 & &\text{dans \(\OO^c\)},
            \\
            \lim_{R\rightarrow\infty}\int_{S_R} |u(\vx)|^2 \dd{S_R}(\vx) = 0,
            \end{align}
        \end{subequations}
        alors \(u=0\) dans \(\OO^c\).
        \end{lemme}
        \begin{proof}
        Voir \cite[p.~74]{cessenat_mathematical_1996}.
        \end{proof}


        On définit les quantités suivantes
        \begin{align}
          X &= \int_\Gamma \vJ(\vx) \cdot \conj{\vE_t}(\vx)\dd{\Gamma(\vx)},
          \label{eq:unicite:x}
          \\
          C &= \int_{S_R} \Tr(\vE_t)(\vx)  \cdot \conj{\vE_t}(\vx)\dd{S_R(\vx)}.
        \end{align}
      
        \begin{align*}
          \intertext{De}
          a(\vE,\vE) &= \frac{1}{ik_0} \int_{\OO^c_R} \norm{\trot \vE(\vx)}^2 \dd{x} + ik_0\int_{\OO^c_R}\norm{\vE(\vx)}^2 \dd{x}
           + X + C,
          \intertext{on déduit}
          \Re(a(\vE,\vE)) & = 0,
          \intertext{ce qui se réecrit}
          \Re(C) + \Re(X) & = 0.
          \intertext{Comme d'après \cite[Théorème~5.3.5, p.~200]{nedelec_acoustic_2001} \(\Re(C) \ge 0\), on en déduit} 
          \Re(X) & \le 0.
        \end{align*}
        L'hypothèse \eqref{eq:unicite:form_var:cgu} \(\Re(X) \ge 0\) impose alors \(\Re(X)=0\) et donc
        \begin{align*} 
          \Re(C) &= 0,
          \intertext{donc d'après le théorème 5.3.5 de Nédélec}
          \vE_t &= 0 && \text{sur \(S_R\)},
          \intertext{et d'après le lemme de Rellich}
          \vE &= 0 && \text{dans \(\OO^c_R\)}.
        \end{align*}
      
        On en déduit \(\vH = 0 \).
      
        On conclut donc que si on suppose \eqref{eq:unicite:form_var:cgu}, alors en l'absence de sources le couple \((\vE,\vH)=(0,0)\) est l'unique solution, ce qui démontre l'unicité par linéarité.
      \end{proof}      

\section{Equations de Maxwell à l'extérieur avec condition limite de Calderon}
    L'opérateur de Caldéron \cite[Def~4, p.~108]{cessenat_mathematical_1996}, lie les traces tangentielles à la surface extérieur de l'objet des champs solutions du problème intérieur et extérieur.
    
    À un couple de domaines ouvert \((\Omega, \Omega^c)\) et à deux problèmes de type Maxwell \eqref{eq:unicite:maxwell_ext} dans chacun des ouverts, est associé un unique opérateur de Caldéron.

    En imposant sur le bord extérieur de l'objet une condition limite utilisant cet opérateur, alors les solutions \((\vE,\vH)\) de ce nouveau problème posé uniquement à l'extérieur sont les même que celles du problème intérieur et extérieur.

    \begin{REM}
        % Je cherche la ref dans le Cessenat, mais si tu l'as, je prend.
        
        Il me semble que tu peux t'appuyer pour Helmholtz sur le Théorème 5 page 106: unicité de la solution du problème extérieur lorsque \(u_0\) est donné dans \(\Sobolev[1/2](\Gamma)\).
        Ou le théorème 6 page 107 pour Maxwell avec \(m_0\) donné dans \(\Sobolev[-1/2](\Gamma)\).
        L'opérateur de Calderon extérieur est alors donné dans la définition 4 page 109.
        
        Il s'agit alors de comparer les solutions des problèmes (P) et (P'), l'un est le problème de Maxwell dans \(\RR^3\) avec condition de radiation à l'infini et l'appartenance à H(rot) des champs, l'autre est le problème de Maxwell dans \(\Omega\) avec opérateur de Calderon extérieur sur le bord.
        J'impose dans (P) et dans (P') la donnée de \(n\wedge E=m_0\) sur \(\Gamma\). (si c'est la restriction à \(\Gamma\), saut nul).
        Le problème (P)  a une unique solution.
        La restriction de cette solution à \(\Omega^c\) peut donc être étudiée.
        
        
        Le problème de Maxwell extérieur admet une unique solution avec \(m_0\) comme donnée. On appelle \((E^*, H^*)\) cette solution , et on déduit \(n\wedge H\vert_{\Gamma_+}= C_e(n\wedge E)_{\Gamma_+})\).
        Traitons maintenant le problème (P') et imposons maintenant dans \(\Omega\) Maxwell avec \((m_0, m_1=C_e(m_0))\) sur \(\Gamma_-\).
        Ce problème a une unique solution \((E_*, H_*)\).
        Si on étudie maintenant \(E=E^*\) dans \(\Omega^c\), \(E=E_*\) dans \(\Omega\), et même chose pour \(H\), les champs ainsi construits sont des élément de \(\Hrot\) (par condition de saut sur \(n\wedge E\) et sur \(n\wedge H\)).
        Ces éléments vérifient Maxwell dans chaque ouvert, satisfont à la condition de rayonnement à l'infini, et par la formule des sauts au sens des distributions vérifient Maxwell partout (exactement comme \(\vert x\vert\) vérifie \((u')^2=1\) partout).
        De plus la trace de \(n\wedge E\) sur \(\Gamma\) est \(m_0\). C'est donc l'unique solution de (P).
        
        
    \end{REM}
    \begin{REM}
    Une autre remarque est que le Théorème 3 page 86 de Cessenat te permet de résoudre séparément le problème intérieur et le problème extérieur, en considérant chaque fois \((E,H)=(0,0)\) à l'intérieur et en mettant la masse de Dirac surfacique comme terme source, et réciproquement.
    \end{REM}

    L'unicité des solutions est aussi assuré par le lemme de Rellich, avec la même condition suffisante d'unicité.

    \subsection{Expression de l'opérateur de Calderon pour un plan infini en tant que multiplicateur de Fourier}

    %    \begin{figure}[!h]
    %        \begin{center}
    %            \tikzsetnextfilename{plan_1_couche}
    %            \begin{tikzpicture}
    %                \input{tikz/schema/plan_1_couche.tikz}
    %            \end{tikzpicture}
    %        \end{center}
    %    \end{figure}

        Pour une couche d'épaisseur \(d (m)\) de matériau diélectrique de constante relative \(\eps,\mu\) et donc de nombre d'onde complexe \(k = k_0\sqrt{\eps\mu}\) et d'impédance relative \(\eta=\sqrt{{\mu}/{\eps}}\), l'opérateur de Calderon s'exprime en Fourier comme un multiplicateur matriciel,

        \begin{align*}
          \hat \mZ(k_x,k_y) &= i\eta\frac{\tan\left(d\sqrt{k^2-k_x^2-k_y^2}\right)}{k \sqrt{k^2-k_x^2-k_y^2}}
          \begin{bmatrix}
            k^2-k_x^2  & -k_xk_y
            \\
            -k_xk_y & k^2-k_y^2
          \end{bmatrix}.
        \end{align*}

        La démonstration de ce calcul, ainsi que son extention à nombre arbitraire de couches est l'objet du chapitre \ref{sec:plan}.

        On remarque que l'opérateur de Calderon ne peut pas être un opérateur différentiel, puisque son multiplicateur de Fourier fait intervenir la racine carré \(\sqrt{k_x^2 + k_y^2}\) ce qui en temporel ne peut s'exprimer avec les opérateurs \(\partial/\partial x, \partial / \partial y\).
        Par contre, on peut approcher cette dernière par un polynôme en \((k_x,k_y)\), voir par une fraction de polynôme, et les CIOE sont issues de cet approximation.
        Cependant cette thèse de ne fera qu'utiliser des CIOE déjà établies.
        Nous renvoyons par exemple à \cite{senior_approximate_1995} pour ce problème.

    \subsection{Expression de l'opérateur de Calderon pour un cylindre infini}

        \begin{REM}
            TODO: Je n'ai jamais le calcul pour une couche. A faire.
        \end{REM}
        \begin{REM}
        Pour Helmholtz, tu démontres que toutes les solutions qui vérifient la condition de Dirichlet en \(r_0\) sur le conducteur parfait sont \(\sum_p a_p(J_p(k_3r)Y_p(k_3r_0)-Y_p(k_3r)J_p(k_3r_0))e^{ip\theta}\) où \(k_3\) est la racine de partie réelle positive de \(\epsilon \mu :\omega^2-k_z^2\), et l'opérateur de Dirichlet to Neumann, pour le mode de Fourier \(p\) sur le bord \(r=R\), est alors (en prenant la dérivée normale)
        \[k_3\frac{J'_p(k_3R)Y_p(k_3r_0)-Y'_p(k_3R)J_p(k_3r_0)}{J_p(k_3R)Y_p(k_3r_0)-Y_p(k_3R)J_p(k_3r_0)}.\]
        Tu peux prendre n'importe quel couple de solutions linéairement indépendantes de l'équation de Bessel.
        
        Pour Maxwell, c'est le calcul que tu as fait en partie, en exprimant \(E\) et \(H\) sur les Bessel, en commencant par \(E_z,H_z\) et en en déduisant \(E_{\theta}, H_{\theta}\). Tu écris \((E_z, H_z)\) avec quatre coefficients de Fourier sur le mode \(e^{ip\theta}\), tu en élimines 1 déjà en mettant
        \[E_z=\sum_p e^{ip\theta}a_p(J_p(k_3r)Y_p(k_3r_0)-Y_p(k_3r)J_p(k_3r_0))\]
        et tu conserves
        \[H_z=\sum_p (c_pJ_p(k_3r)+d_pY_p(k_3r))e^{ip\theta}.\]
        Tu déduis alors \(E_{\theta}, H_{\theta}\). En particulier \(E_{\theta}\) dépend de \(c_p, d_p, p\geq 0\), et tu obtiendras une relation sur les coefficients à partir de \(E_{\theta}(r=r_0)=0\). 
        \end{REM}

        \begin{REM}
            Ce qui suit est issu de ton TEX.
        \end{REM}
            \begin{align*}
                S_n(k_3r)&=\frac{J'_n(k_3r_0)Y_n(k_3r)-Y'_n(k_3r_0)J_n(k_3r)}{J'_n(k_3r_0)Y'_n(k_3R)-Y'_n(k_3r_0)J'_n(k_3R)},
                \\
                T_n(k_3r)&=\frac{J_n(k_3r_0)Y'_n(k_3r)-Y_n(k_3r_0)J'_n(k_3r)}{J_n(k_3r_0)Y_n(k_3R)-Y_n(k_3r_0)J_n(k_3R)},
                \\
                Q_n(k_3r)&=\frac{J_n(k_3r_0)Y_n(k_3r)-Y_n(k_3r_0)J_n(k_3r)}{J_n(k_3r_0)Y_n(k_3R)-Y_n(k_3r_0)J_n(k_3R)},
                \\
                R_n(k_3r)&=\frac{J'_n(k_3r_0)Y'_n(k_3r)-Y'_n(k_3r_0)J'_n(k_3r)}{J'_n(k_3r_0)Y'_n(k_3R)-Y'_n(k_3r_0)J'_n(k_3R)}.
            \end{align*}
            We notice that these functions do not depend on the choice of the pair of fundamental solutions of the Bessel equation considered. 

            \begin{lemma} The Calderon operator for the cylindrical annulus is given by
            $$
                \begin{pmatrix}
                    -H_{\theta}
                    \cr
                    H_z
                \end{pmatrix}
                =
                    \begin{pmatrix}
                        \frac{i\omega \epsilon}{k_3}T_n(k_3R)-\frac{ik_z^2n^2}{k_3^3R^2\omega \mu}S_n(k_3R) & -\frac{ik_zn}{k_3R\omega \mu}S_n(k_3R)
                        \cr
                        \frac{ik_zn}{k_3R\omega \mu}S_n(k_3R) & \frac{ik_3}{\omega \mu}S_n(k_3R)
                    \end{pmatrix}
                    \begin{pmatrix}
                        E_z
                        \cr
                        E_{\theta}
                    \end{pmatrix}.
            $$
            \end{lemma}

            \begin{lemma}
                \begin{enumerate}
                \item If the domain is $C(r_0,R)\times R$ and if $\varepsilon \mu \notin \mathbb R^*_+$, there is no resonance.
                \item If the domain is $C(r_0, R)\times [0,L]$, and $d_n(k_3R)(dd_n)'(k_3R)\not=0$, there is no resonance.
                \end{enumerate}
            \end{lemma}
            Introduce now, in the case $d_n(R)dd_n(R)\not=0$, the functions
            \begin{align*}
                S_n(rk_3) &= \frac{J'_n(k_3r_0)Y_n(k_3r)-Y'_n(k_3r_0)J_n(k_3r)}{J'_n(k_3r_0)Y'_n(k_3R)-Y'_n(k_3r_0)J'_n(k_3R)},
                \\
                T_n(k_3r) &= \frac{J_n(k_3r_0)Y'_n(k_3r)-Y_n(k_3r_0)J'_n(k_3r)}{J_n(k_3r_0)Y_n(k_3R)-Y_n(k_3r_0)J_n(k_3R)}.
            \end{align*}
            We notice that these functions do not depend on the choice of the pair of fundamental solutions of the Bessel equation considered. 

            Introduce for simplicity $D_n(k_3r)=k_3^{-1}(dd_n)'(k_3r)= J'_n(k_3r_0)Y'_n(k_3r)-Y'_n(k_3r_0)J'_n(k_3r)$.

            \begin{lemma}
            \label{Z-lemme}
            For the cylindrical annulus, the Calderon operator is characterized, under the conditions $d_n(R)(dd_n)'(R)\not=0$ for all $n$, and $k_3\not=0$, by
            $$
            \begin{pmatrix}
                H_{\theta}
                \\
                -H_z
            \end{pmatrix}
            =
            \begin{pmatrix}
                \frac{i\omega \epsilon}{k_3^2}T_n(k_3R)+\frac{k_z^2n^2}{i\omega \mu R^2k_3^2}S_n(k_3R)\frac{d_n(R)}{D_n(k_3R)} & \frac{k_zn}{i\omega \mu R}
                \\
                \frac{kn}{i\omega \mu R}S_n(k_3R)\frac{d_n(k_3R)}{D_n(k_3k_3R)} & \frac{k_3^2}{i\omega \mu}S_n(k_3R)\frac{d_n(k_3R)}{D_n(k_3R)}
            \end{pmatrix}
            \begin{pmatrix}
                E_z
                \\
                E_{\theta}
            \end{pmatrix}.$$
            \end{lemma}

            \begin{remark}
                The conditions for existence and uniqueness of a solution for a multi-layer annulus is not the intersection of the conditions for each layer. For example, for two layers of dielectric materials, of dielectric constants $(\epsilon, \mu), r_0<r<r_1$ and $(\epsilon_1, \mu_1), r_1<r<R$, the conditions induced by $E_z$ are
                \begin{multline*}
                    (k_3^1)^{-1}(J_n(k_3r_0)Y_n(k_3r_1)-J_n(k_3r_1)Y_n(k_3r_0))[J_n(k_3^1R)Y'_n(k_3^1r_1)-Y_n(k_3^1R)J'_n(k_3^1r_1)]
                    \cr
                    \not=
                    \\
                    (k_3)^{-1}(J_n(k_3r_0)Y'_n(k_3r_1)-J'_n(k_3r_1)Y_n(k_3r_0))[J_n(k_3^1R)Y_n(k_3^1r_1)-Y_n(k_3^1R)'_n(k_3^1r_1)].
                \end{multline*}

                This condition does not depend, again, on the choice of the pair of independent solutions of the Bessel equation chosen in each layer.
            \end{remark}

            \begin{proof}
                Consider for the moment formal solutions of the Helmholtz equations obtained on $E_z,H_z$.
                After Fourier transform in $z$ and expanding in Fourier series in $\theta$, one has, for $k_3\not=0$
                \begin{align*}
                    E_z&=aJ_n(k_3r)+bY_n(k_3r)\cr
                    H_z&=cJ_n(k_3r)+dY_n(k_3r).
                \end{align*}
                We now deduce $H_{\theta}$ and $E_{\theta}$ through the equalities 3 and 5 of (\ref{systeme-Fourier-cyl}), after replacing $E_r, H_r$ using the equalities 1 and 2 of (\ref{systeme-Fourier-cyl}) for $k_3\not=0$:
                \begin{align*}
                    H_{\theta}&=\frac{i\omega \epsilon}{k_3^2}[\frac{dE_z}{dr}+\frac{ik_zn}{\omega \epsilon r}H_z]&=& \frac{i\omega \epsilon}{k_3^2}\frac{dE_z}{dr}-\frac{k_zn}{k_3^2 r}H_z
                    \\
                    E_{\theta}&=-\frac{i\omega \mu}{k_3^2}[\frac{dH_z}{dr}-\frac{ink_z}{\omega \mu r}E_z]&=&-\frac{i\omega \mu}{k_3^2}\frac{dH_z}{dr}-\frac{nk_z}{k_3^2 r}E_z
                \end{align*}

            that is
            \begin{equation}
                \label{HthetaEtheta}
                \begin{aligned}
                H_{\theta}&=\frac{i\omega \epsilon}{k_3}(aJ'_n+bY'_n)-\frac{k_zn}{k_3^2r}( cJ_n+dY_n)
                \\
                 E_{\theta}&=-\frac{i\omega \mu}{k_3} (cJ'_n+dY'_n)-\frac{k_zn}{k_3^2r}( aJ_n+bY_n).
                \end{aligned}
            \end{equation}
            Any solution of the Cauchy problem on $ (E_z,E_{\theta},H_z,H_{\theta})$ stated in lemma \ref{maxwell-cylinder}, in the case $k_3\not=0$ can be written
            \begin{multline*}
                \begin{pmatrix}
                    E_z
                    \cr
                    E_{\theta}
                    \cr
                    H_z=\frac{ik_3}{\omega \mu}(E_{\theta}^0+\frac{k_zn}{k_3^2R}E_z^0)S_n(R)\frac{d_n(r)}{d_n(R)}
                    \cr
                    H_{\theta}
                \end{pmatrix}
                \\
                =
                a\begin{pmatrix}
                    J_n(k_3r)
                    \cr
                    -\frac{nk_z}{k_3^2r}J_n(k_3r)
                    \cr
                    0
                    \cr
                    \frac{i\omega \epsilon}{k_3}J'_n(k_3r)
                \end{pmatrix}
                +b\begin{pmatrix}
                    Y_n(k_3r)
                    \cr
                    -\frac{nk_z}{k_3^2r}Y_n(k_3r)
                    \cr
                    0
                    \cr
                    \frac{i\omega \epsilon}{k_3}Y'_n(k_3r)
                \end{pmatrix}
                +c\begin{pmatrix}
                    0
                    \cr
                    -\frac{i\omega \mu}{k_3}J'_n(k_3r)
                    \cr
                    J_n(k_3r)
                    \cr
                    -\frac{k_zn}{k_3^2r}J_n(k_3r)
                \end{pmatrix}
                +d
                \begin{pmatrix}
                    0
                    \cr
                    -\frac{i\omega \mu}{k_3}Y'_n(k_3r)
                    \cr
                    Y_n(k_3r)
                    \cr
                    -\frac{k_zn}{k_3^2r}Y_n(k_3r)
                \end{pmatrix}
            \end{multline*}
            which defines a fundamental basis of the Cauchy problem.

            For one annulus, the boundary conditions  $E_{\theta}(r_0)=0$, $E_z(r_0)=0$ yield
            \begin{align*}
                a J_n(k_3r_0)+bY_n(k_3r_0)&=0
                \\
                cJ'_n(k_3r_0)+dY'_n(k_3r_0)&=0.
            \end{align*}
            The boundary conditions at $r=R$ yield
            \begin{align*}
                aJ_n(k_3R)+bY_n(k_3R) &= E_z^0
                \cr
                cJ'_n(k_3R)+dY'_n(k_3R) &= \frac{ik_zn}{k_3R\omega \mu}E^0_z+\frac{ik_3}{\omega \mu}E_{\theta}^0.
            \end{align*}

            Collecting, we have
            \begin{align*}
                a J_n(k_3r_0)+bY_n(k_3r_0)&=0
                \cr
                aJ_n(k_3R)+bY_n(k_3R)&= E_z^0
                \cr
                cJ'_n(k_3r_0)+dY'_n(k_3r_0)&=0
                \cr
                cJ'_n(k_3R)+dY'_n(k_3R)&= \frac{ik_zn}{k_3R\omega \mu}E^0_z+\frac{ik_3}{\omega \mu}E_{\theta}^0,
            \end{align*}
            which gives two decoupled systems.
            Hence, under $d_n(k_3R)(dd_n)'(k_3R)\not=0$ there is existence and uniqueness of a solution of this system.
            Note that the condition $d_n(k_3R)(dd_n)'(k_3R)\not=0$ do not depend on the pair of independent solutions of the Bessel equation chosen because there exists, for any pair $\{f,g\}$ of independent solutions of Equation (\ref{eq-bessel}), a constant $C(f,g)$ such that $f(r_0)g(R)-f(R)g(r_0)=C(f,g)d_n$.
            The condition $d_n(R)(dd_n)'(R)=0$ was obtained in Pierre Payen's thesis but the operator was not expressed in a simple form, which is the aim of the end of this proof.


            The solution of the system on $(a,b,c,d)$ is:

            \begin{align*}
                a&=-\frac{Y_n(k_3R)}{d_n(k_3R)}E_z^0
                \cr
                b&=\frac{J_n(k_3R)}{d_n(k_3R)}E_z^0
                \cr
                c&=-\frac{Y'_n(k_3R)}{D_n(k_3R)}[\frac{ik_zn}{k_3R\omega \mu}E^0_z+\frac{ik_3}{\omega \mu}E_{\theta}^0]
                \cr
                d&=\frac{J'_n(k_3R)}{D_n(k_3R)}[\frac{ik_zn}{k_3R\omega \mu}E^0_z+\frac{ik_3}{\omega \mu}E_{\theta}^0],
            \end{align*}
            One deduces
            $$E_z(r)=E_z^0\frac{d_n(k_3r)}{d_n(k_3R)}, H_z(r)=[\frac{ik_zn}{k_3R\omega \mu}E^0_z+\frac{ik_3}{\omega \mu}E_{\theta}^0]\frac{dd_n(k_3r)}{D_n(k_3R)}=\frac{ik_3}{\omega \mu}[\frac{k_zn}{k_3^2R}E^0_z+E_{\theta}^0]S_n(r).$$
            We use then (\ref{HthetaEtheta}) to deduce the two other components. In particular
            $$\frac{dE_z}{dr}(r)=k_3E_z^0\frac{d'_n(k_3r)}{d_n(k_3R)}=E_z^0k_3T_n(k_3r),\frac{dH_z}{dr}(r)=\frac{ik_3^2}{\omega \mu}[E_{\theta}^0+\frac{ik_zn}{k_3^2R}E^0_z]\frac{D_n(r)}{D_n(R)},$$
            which yields
            \begin{align*}
                H_{\theta}&=\frac{i\omega \epsilon}{k_3}E_z^0T_n(k_3r)-\frac{ik_zn}{k_3r\omega \mu}[E_{\theta}^0+\frac{ik_zn}{k_3^2R}E^0_z]S_n(k_3r),
                \cr
                E_{\theta}&=[E_{\theta}^0+\frac{ik_zn}{k_3^2R}E^0_z]\frac{D_n(k_3r)}{D_n(k_3R)}-\frac{k_zn}{k_3^2r}E_z^0\frac{d_n(k_3r)}{d_n(k_3R)}.
            \end{align*}
            Collection, the electromagnetic fields that were obtained here are 
            \begin{align}
                E_z(r)&=\frac{d_n(k_3r)}{d_n(k_3R)}E_z^0,
                \cr
                E_{\theta}(r)&=[E_{\theta}^0+\frac{k_zn}{k_3^2R}E^0_z]\frac{D_n(k_3r)}{D_n(k_3R)}-\frac{nk_z}{k_3^2 r}\frac{d_n(k_3r)}{d_n(k_3R)}E_z^0
                \cr
                H_z(r)&=\frac{ik_3}{\omega \mu}[E_{\theta}^0+\frac{k_zn}{k_3^2R}E^0_z]S_n(k_3r)
                \cr
                H_{\theta}(r)&=-\frac{ik_zn}{k_3\omega \mu r}[E_{\theta}^0+\frac{k_zn}{k_3^2R}E^0_z]S_n(k_3r)+\frac{i\omega \epsilon}{k_3}E_z^0T_n(k_3r)
            \label{formal-solutions}
            \end{align}
            As before, these expressions do not depend on the pair of independent solutions of the Bessel equation chosen.

            Note that 
            \begin{align*}
                H_z(R)&=\frac{ik_3}{\omega \mu}[E_{\theta}^0+\frac{k_zn}{k_3^2R}E^0_z]S_n(R)
                \cr
                H_{\theta}(R)&=-\frac{ik_zn}{k_3\omega \mu R}[E_{\theta}^0+\frac{k_zn}{k_3^2R}E^0_z]S_n(R)+\frac{i\omega \epsilon}{k_3}E_z^0T_n(R),
            \end{align*}
            which yields the Calder\`on operator.
            \end{proof}

            \begin{REM}
                Verification avec le calcul matriciel:
            \end{REM}

            Soit \(J_n\) la fonction de Bessel de première espèce et \(H_n^{(2)}\) la fonction de Hankel de deuxième espèce.
    
            Pour un cylindre de rayon \(r_0 [m]\) recouvert d'une couche d'épaisseur \(d [m]\) (on note \(r_1=r_0 + d\)) de matériau diélectrique de constante relative \(\eps,\mu\) et donc de nombre d'onde complexe \(k = k_0\sqrt{\eps\mu}\) et d'impédance relative \(\eta=\sqrt{{\mu}/{\eps}}\), l'opérateur de Calderon s'exprime en tant que multiplicateur de Fourier matriciel en \((n,k_z)\) où \(n\) est l'indice d'un coefficient de série de Bessel ( qui est une série de Fourier sur \(\theta\) ) et \(k_z\) est la variable de Fourier associée à la transformée de Fourier partielle en \(z\):

            \subsubsection{Expression de l'opérateur de Calderon quand \(k_z=0\)}
              Le cas de l'incidence perpendiculaire à l'axe du cylindre simplifie grandement les calculs, car cette matrice est alors diagonale:

              \begin{align*}
                (\hat\mZ_n(0))_{11} &= \frac{i}{\eta}\frac{
                  (H^{(2)}_n)'(kr_1)(J_n)'(kr_0)-(J_n{})'(kr_1)(H^{(2)}_n)'(kr_0)
                }{
                  H^{(2)}_n(kr_1)(J_n)'(kr_0)-J_n(kr_1)(H^{(2)}_n)'(kr_0)
                },
                \\
                (\hat\mZ_n(0))_{12} &= 0,
                \\
                (\hat\mZ_n(0))_{21} &= 0,
                \\
                (\hat\mZ_n(0))_{22} &=-i\eta\frac{
                    H^{(2)}_n(kr_1)J_n(kr_0)-J_n(kr_1)H^{(2)}_n(kr_0)
                  }{
                    (H^{(2)}_n)'(kr_1)J_n(kr_0)-(J_n)'(kr_1)H^{(2)}_n(kr_0)
                  }.
              \end{align*}

            \subsubsection{Expression de l'opérateur de Calderon général}

              \begin{align*}
                \hat \mZ_n(k_z) &= 
              \end{align*}

    \subsection{Expression de l'opérateur de Calderon pour une sphère infini}

        Soit \(j_n\) la fonction de Bessel sphérique de première espèce et \(h_n^{(2)}\) la fonction de Hankel sphérique de deuxième type.

        On utilise la notation \gls{mat-tild} pour désigner les dérivées de ces fonctions telles que \(\tilde{f}(z) = \ddp{z}{(zf(z))}\).

        Pour une sphère de rayon \(r_0 [m]\) recouverte d'une couche d'épaisseur \(d [m]\) (on pose \(r_1=r_0 + d\)) de matériau diélectrique de constante relative \(\eps,\mu\) et donc de nombre d'onde complexe \(k = k_0\sqrt{\eps\mu}\) et d'impédance relative \(\eta=\sqrt{{\mu}/{\eps}}\), l'opérateur de Calderon s'exprime tant que coefficient de série de Mie matriciel,

        \begin{multline*}
          \hat \mZ_n = \\
          i\eta \begin{bmatrix}
            kr_1 
             \frac{
                 h^{(2)}_n(kr_1)j_n(kr_0)-j_n(kr_1)h^{(2)}_n(kr_0)
               }{
                 \tilde{h^{(2)}_n}(kr_1)j_n(kr_0)-\tilde{j_n}(kr_1)h^{(2)}_n(kr_0)
               }
               & 0
            \\
            0 & \frac{1}{kr_1}
               \frac{
                 \tilde{h^{(2)}_n}(kr_1)\tilde{j_n}(kr_0)-\tilde{j_n}(kr_1)\tilde{h^{(2)}_n}(kr_0)
               }{
                 {h^{(2)}_n}(kr_1)\tilde{j_n}(kr_0)-{j_n}(kr_1)\tilde{h^{(2)}_n}(kr_0)
               }
          \end{bmatrix}.
        \end{multline*}

\section[Problème extérieur et condition limite de Calderon]{Equations de Maxwell à l'extérieur de l'objet avec une approximation de l'opérateur de Calderon sur son bord}

    \subsection{Approximation constante de l'operateur de Calderon: la condition de Leontovich}
        
        Définie par \cite{leontovich_investigations_1948}, cette condition d'impédance consiste à approcher l'opérateur de Calderon par une constante.
        Très facile à mettre en oeuvre, elle est néamnoins une bonne approximation pour des incidences proche de l'oblique (\((k_x,k_y)=(0,0)\)) (\cite{leontovich_investigations_1948}) et dont l'indice relatif \(|\sqrt{\eps\mu}|\) est grand devant l'unité (\cite[par.~3, p.421-422]{senior_impedance_1960}).

    \subsection{Approximation de Taylor et Padé: les CIOE}

        \subsubsection{Taylor à l'ordre 1: la CI01}

        \subsubsection{Padé à l'ordre 1:1: la CI1}

        \subsubsection{Padé à l'ordre 1:1, découplé: la CI3}

        \subsubsection{Taylor à l'ordre 1, découplé: la CI4}

        \begin{REM}
            Note de Lundi soir

            "Il est bien entendue que pour chaque \gls{acr-cioe}, le problème avec une onde incidente, conduit s'il y a unicité à une unique solution diffractée, et donc à des solutions diffractées differentes, dont on espère qu'elles sont une approximation de la solution exacte du probleme diffracté avec opérateur de calderon"

            Tout le pb est de choisir les coeffs complexes, obtenues grâce à des approximations issues de critères physiques mais non issus de cette derniere. 

            Il est inutile de considerer des coefficients qui ne permettraient pas d'obtenir une unique solution.
            Plus exactement, comme on ne connait pas de condition nécessaire et suffisante d'existence et d'unicité, on se contentera de {\bf garantir} l'unicité de la solution dans des cas plus restreints, ceux de conditions {\bf suffisantes} d'unicité. 
            
            Si on n'a pas unicité, il est aussi clair que, pour un problème avec source, on peut ne pas avoir existence.
            L'existence, en revanche, est assurée si la source est nulle puisque la solution nulle vérifie toutes les conditions du problème.
        \end{REM}

    \subsection{Etude de l'unicité des solutions: conditions suffisantes d'unicité}

        \begin{REM}
            Note de Lundi soir
            CSU <= RE(X)>=0 (1.1.3). CIOE + CSU

            5.1 1.1.3 => 1.1.1 1.1.2 a  unique solution = 0

            5.2 CSU J => 1.1.3 => PJ (1.1.1 1.1.2 + CIOE) a unique solution 0

            /!\textbackslash  Un operateur / Des CIOE
        \end{REM}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% @Olivier: Décommente les lignes ci dessous

\backmatter
\appendix
\printbibliography
\end{document}
