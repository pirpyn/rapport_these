\section{Solutions du problème de Helmholtz dans la sphère}\label{sec_helmholtz_scal}

Nous cherchons une solution de l'équation de Helmholtz \eqref{eq_sol_maxwell_helmholtz_scal} dans le cas où $\O$ est la sphère unité. Par séparation des variables%\footcite[p.~1264]{morse_methods_1953}
, nous allons exhiber des solutions fondamentales appelées harmoniques sphériques.
%% subsection intro

Soient $k \in \C, \O = B(0,1), \O^c = \R^3 \backslash \overline{\O}$. 

Le Laplacien s'écrit en coordonnées sphériques : 
\[ 
  \gls{ope-laps} \Psi := \frac{1}{r^2}\left[
  \frac{\d}{\d r}\left(r^2\dd{r}\Psi\right) 
  + \frac{1}{\sin(\theta)}\dd{\theta}\left(\sin(\theta)\dd{\theta}\Psi\right)
  + \frac{1}{\sin^2(\theta)} \frac{\d^2}{\d\phi^2} \Psi \right]
\]

\subsection{Solution particulière de Helmholtz par séparation des variables}
\begin{hyp}
Dans la base des coordonnées sphériques, on suppose que l'on peut écrire $\Psi(\rtp) : = f(r)g(\theta)h(\phi)$. 
\end{hyp}
\begin{prop}
\begin{equation}
\forall m \in \Z, \quad h(\phi) = e^{im\phi}
\end{equation}
\end{prop}
\begin{proof}
On note $f' =\dr{r}{f}, g' = \dr{\theta}{g} , h' = \dr{\phi}{h}$. On omettra les dépendances en $\rtp$ dans $f,g,h$ pour alléger les notations.

L'équation de Helmholtz s'écrie à l'intérieur\footnote{Le cas extérieur est analogue en changeant $k$ pour $k_0$.} de la sphère : 
\begin{equation}\label{eq_helm_helm}
  \Delta \Psi + k^2 \Psi = gh\frac{1}{r^2}\dd{r}(r^2f') + \frac{1}{r^2}\left[\frac{fh}{\sin(\theta)}\dd{\theta}(\sin(\theta)g')+\frac{fg}{\sin^2(\theta)}h''\right] + k^2 fgh = 0 \; \forall (r,\tp)
\end{equation}

On suppose que $ \frac{r^2\sin^2(\theta)}{f(r)g(\theta)h(\phi)}$ ne peut pas s'annuler. Alors on multiplie l'équation de Helmholtz par ce terme pour faire apparaître 2 termes dépendant de variables différentes: un terme variant selon $(r)$, l'autre selon $(\tp)$. 

\begin{align*}
\frac{r^2}{fgh} \left(\Delta \Psi + k^2 \Psi\right) &= 
\left(\frac{1}{f}\dd{r}{r^2f'} + (kr)^2\right) + 
\left(\frac{1}{ \sin(\theta)g} \dd{\theta}(\sin(\theta)g') +  \frac{1}{ \sin^2(\theta)}\frac{h''}{h} \right)\\
0 &=R(r) + \Theta(\tp)
\end{align*}
Chaque terme doit donc être égal à une constante dont le somme sera nulle. En séparent les dépendances en $\theta$ et $\phi$ dans $\Theta$, on trouve que chaque terme est aussi constant:

  %On notera que les deux termes doivent être constant.\\
\[ 
\exists z_h \in \C,\; \frac{h''}{h} = z_h^2 \Rightarrow h(\phi) = e^{z_h\phi}
\]

De plus, par définition du repère sphérique, $h(\phi)$ $2\pi$-périodique:
\[
h(\phi) = h(\phi + 2\pi) \Leftrightarrow e^{z_h2\pi}= 1 \Rightarrow \forall m \in \Z, z_h = im
\]
%On a donc déterminé la fonction $h$:
%\begin{equation}
%\forall m \in \Z, \quad h(\phi) = e^{im\phi}
%\end{equation}
\end{proof}

%%% subsection g 
\begin{prop}$\forall m \in \Z, \forall \nu \in \C$, soit $\P^m_\nu$ la fonction de Legendre associée. Alors
  \begin{equation} 
    g(\theta) := \P^m_\nu(\cos \theta)
  \end{equation}
\end{prop}
\begin{proof}

En injectant $h$ dans l'équation de Helmholtz normalisée par un facteur $\frac{r^2}{fgh}$ on obtient
\begin{align*}
     \frac{r^2}{fgh} \left(\Delta \Psi + k^2 \Psi\right) &= 
     \left(\frac{1}{f}\dd{r}{r^2f'} + (kr)^2\right) + 
     \left(\frac{1}{g\sin(\theta)} \dd{\theta}(\sin(\theta)g') -  \frac{m^2}{\sin^2(\theta)}\right) \\
 0 &= R(r) + A(\theta)
\end{align*}

$A(\theta)$ est donc une constante:

\[
 \exists A \in \C, \frac{1}{g\sin\theta}\left(\dd{\theta}\left(\sin\theta\dd{\theta}g\right)\right)  -\frac{m^2}{\sin^2\theta} = A
\]
  On multiplie alors cette expression par $g$

  \begin{equation*}
    \label{eq_helm_legendre}\frac{1}{\sin\theta}\left(\dd{\theta}\left(\sin\theta\dd{\theta}g\right)\right) + \left[- A -\frac{m^2}{\sin^2\theta}\right]g = 0
  \end{equation*}

%On obtient une équation qui n'a de solution non triviales qui si $A$ est valeur propre de l'opérateur $\frac{1}{\sin\theta}\left(\dd{\theta}\left(\sin\theta\dr{\theta}{\cdot}\right)\right) -\frac{m^2}{\sin^2\theta}\operatorname{id}$. Plus précisément, 
Dans la littérature \cite{abramowitz_handbook_1964}, on fait apparaître "l'équation différentielle associée de Legendre" car il existe $
%\forall A \in \C,
\nu \in \C,-A = \nu(\nu + 1)$. Des solutions de ce problème sont les fonctions associées de Legendre du 1er type, notées $\P^m_\nu(\cos \theta)$ 

D'apres \cite[p.~1264]{abramowitz_handbook_1964}, \cite[p.~84]{bohren_absorption_2004}, $\nu \in \N, n\ge m $. On pose alors $n = \nu$.


{ \color{red}
\textbf{Tentative de justification}

Les fonctions associées de Legendre s'expriment en fonction de la fonction hypergéométrique $F(a,b,c,x)$ \cite[p.~332]{abramowitz_handbook_1964}.

\[
P^m_\nu(z) = \frac{1}{\Gamma\left(1-m\right)}\left(\frac{z+1}{z-1}\right)^{m/2}F\left(-\nu,\nu+1,1-m;\frac{1-z}{2}\right)
\]

Comme $z=\cos\theta \in [-1,1] $, $\frac{1-z}{2} \in [0,1]$ donc on se situe dans le rayon de convergence de la série entière de la fonction hypergéométrique. Cette dernière n'est pas définie si $\forall p\in \N, m=1+p $ sauf si $\forall n \in [0,m[, -\nu = -n $ ou alors $ \nu +1 = -n $ \cite[p.~556]{abramowitz_handbook_1964}. Dans ce cas, la série devient un polynôme de dégrée $m$ \cite[p.~561]{abramowitz_handbook_1964}.

On conclus que pour obtenir des solutions définis pour tout $m$, alors $\nu:=n \in \N, n< m $.
}


\end{proof}


%%% subsection f
\begin{prop} Soit $j_n$ (resp. $h_n$ la fonction de Bessel (resp. Hankel) d'ordre $n$.
  \begin{equation}
    f(r) := \left\lbrace
    \begin{matrix}
    j_n(kr) & \text{ dans $\O$ } \\
    h_n(k_0r) & \text{ dans } \O^c \\
    \end{matrix}\right.
  \end{equation}
\end{prop}
\begin{proof}
On normalise une dernière fois l'équation de Helmholtz en remplaçant les derniers termes par la constante exhibée précédemment.

\begin{align*}
\frac{r^2}{gh} \left(\Delta \Psi + k^2 \Psi\right) &= 0 \\
&= \dd{r}{\left(r^2f'\right)} + \left((kr)^2 - n(n+1)\right)f
\end{align*}
  On voit alors apparaître l'équation de Bessel d'ordre $n +1/2$ dont des solutions linéairement indépendantes sont les fonctions de Bessel du premier type $J_{n+1/2}$ et du deuxième type $Y_{n+1/2}$\cite[p.~86]{bohren_absorption_2004}\cite[p.~1465]{morse_methods_1953}. 
  On crée de $J_{n+1/2}$ et $Y_{n+1/2}$ les fonction de Bessel sphériques $j_n$ et $y_n$ 
  \begin{align*}
  j_n(kr) &= \sqrt{\frac{\pi}{2kr}}J_{n+1/2}(kr) &
  y_n(kr) &= \sqrt{\frac{\pi}{2kr}}Y_{n+1/2}(kr)
  \end{align*}
  Lorsque $r$ tend vers $0$, les $y_n(r)$ tendent vers l'infini. On présente aussi comme solution une combinaisons linéaires de ces deux solutions: les fonctions de Bessel sphérique du troisième type $h_n$:
  \[
  h_n(kr)=j_n(kr)-i y_n(kr)
  \]
  Les $h_n$ sont aussi singulières à l'origine pour tout $n$. On choisit alors de prendre alternativement l'une ou l'autre selon le domaine
  \end{proof}


\subsection{Solutions scalaire de l'équation de Helmholtz sur la sphère}

On définit les harmoniques sphériques comme les fonctions $Y_n^m = C(m,n) e^{im\phi}\mathbb{P}^m_n(\cos \theta) $ avec $C(m,n)$ tel que,
\[
 \ds\int_S Y_{m,n} \conj{Y_{p,\tau}} ds = \delta_m^p \delta_n^\tau
\]

D’après \cite[p.~24]{nedelec_acoustic_2001}, $ C(m,n) = (-1)^m\sqrt{\frac{2n+1}{4\pi}\frac{(n-m)!}{(n+m)!}}$

De fait, ces fonctions forment une base des fonctions $L_2$ sur la sphère unité solution de l'équation de Helmholtz: soit $f(\tp) \in L_2(S)$ solution de $ \Delta f + k^2 f = 0 $ alors
  \begin{align}
    f(\tp) &= \sum\limits_{n=1}^\infty\sum\limits_{m=-n}^n f_{m,n} Y_{m,n} (\tp)\\
    \notag f_{m,n} &= \int_S f(\tp) Y_{m,n}(\tp) ds
  \end{align}


\subsection{Solutions scalaires de l'équation de Helmholtz dans $\R^3$}
On peut étendre ces solutions à tout l'espace pour obtenir une solution pour un champ scalaire .

Tout champ scalaire $\Psi$ solution de l'équation de Helmholtz s'écrit dans $\O\cup\O^c$:
\begin{align} 
\label{eq_helm_sol_helmoltz_scal_somme}
\Psi(\rtp) &= \sum\limits_{n=1}^\infty\sum\limits_{m=-n}^n a_{m,n} \Psi_{m,n}(\rtp) \\
\Psi_{m,n}(\rtp) &= z_n(r) Y_{m,n}(\tp) \\
\notag a_{m,n} &= \int_S \Psi(1,\tp) Y_{m,n}(\tp) ds \\
z_n(r) &= \left\lbrace
  \begin{matrix}
  j_n(kr) &   \text{dans $\O~$} \\
  h_n(k_0r) & \text{dans $\O^c$} \\
  \end{matrix}\right.
\end{align}
