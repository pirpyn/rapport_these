\section{Cas d'un objet cylindrique}

    On rappelle les formules des opérateurs $\vdiv, \vrot$ en coordonnée cylindrique $(r,\theta,z)$.
    \begin{align}
        \vrot \v{V} &= \left(\frac{1}{r}\ddr{\theta}{V_z} - \ddr{z}{V_\theta}\right)\v{e_r} + 
        \left(\ddr{z}{V_r} - \ddr{r}{V_z}\right)\v{e_\theta} +
        \frac{1}{r}\left(\ddr{r}{(rV_\theta)}-\ddr{\theta}{V_r}\right)\v{e_z} 
        \\
        \vdiv \v{V} &= \frac{1}{r}\ddr{r}{(rV_r)}+\frac{1}{r}\ddr{\theta}{V_\theta}+\ddr{z}{V_z}
    \end{align}

    On exprime les équations de Maxwell dans le matériau dans cette base et sans pertes de généralité, on peut réaliser une transformée de Fourier en $z$ par invariance en translation et en $\theta$ par invariance en rotation. Cependant, le multiplicateur de Fourier associé à la coordonnée $\theta$ doit être un entier pour assurer la périodicité. On le note $n$.

    \begin{align}
        \vrot \vE &= i\left(\frac{n}{r}E_z - k_zE_\theta\right)\v{e_r} + 
        \left(ik_zE_r - \ddr{r}{E_z}\right)\v{e_\theta} +
        \frac{1}{r}\left(\ddr{r}{(rE_\theta)}-inE_r\right)\v{e_z}
        \\
        &=i\w\mu \vH
    \end{align}

    On remarque que dans ce cas, la méthode utilisée pour le plan aboutie à une EDO à coefficients non constant de type $r\ddr{r}{X}(r) = M(r)X(r)$.

    On ne peut pas exprimer la solution avec les valeurs et vecteurs propres de la matrice. 
    %Nous allons donc trouver une équation de Bessel en développant le système de Maxwell.
    On développe le système de Maxwell:

    \begin{align}
        \vrot \vrot \vE &= \w^2\eps\mu \vE
        \\
        \vdiv \vE &= 0
    \end{align}

    \begin{multline}
        \vrot \vrot \vE = \dots\\
        i\left(\frac{n}{r^2}\left(\ddr{r}{(rE_\theta)} - inE_r\right) - k_z\left(ik_zE_r - \ddr{r}{E_z}\right)\right)    \v{e_r} \dots\\ 
        + \left(-k_z\left(\frac{n}{r}E_z - k_zE_\theta\right) -\ddr{r}{}\left(\frac{1}{r}\left(\ddr{r}{(rE_\theta)}-inE_r\right)\right)\right)    \v{e_\theta} \dots\\
        + \frac{1}{r}\left(\ddr{r}{} \left(r\left(ik_zE_r - \ddr{r}{E_z}\right)\right) + n \left(\frac{n}{r}E_z - k_zE_\theta\right)\right) \v{e_z}
    \end{multline}

    On aboutit au système suivant,
    \begin{equation}
        \left\lbrace
        \begin{array}{ccc}
            -\left(\w^2\eps\mu -\frac{n^2}{r^2}  - k_z^2\right)E_r  +i\frac{n}{r^2}\ddr{r}{(rE_\theta)}  +k_z\ddr{r}{E_z} & = & 0\\
            in\ddr{r}{}\left(\frac{E_r}{r}\right) -\left(\w^2\eps\mu - k_z^2\right)E_\theta + \ddr{r}{}\left(\frac{1}{r}\ddr{r}{(rE_\theta)}\right)  - n\frac{k_z}{r}E_z & = & 0\\
            i\frac{k_z}{r}\ddr{r}{(rE_r)}  - n\frac{k_z}{r}E_\theta  -\left(\w^2\eps\mu - \frac{n^2}{r^2} \right)E_z - \frac{1}{r}\ddr{r}{}\left(r\ddr{r}{E_z}\right) & = & 0
        \end{array}
        \right.
    \end{equation}

    Comme l'on cherche $\vE_t, \vH_t$, on cherche une équation différentielle à résoudre sur $E_z$, puis on en déduira $\vE_t$.

    De la troisième  équation, on trouve pour $r\not=0$
    \begin{equation}
    r^2 \ddr[2]{r}{E_z} + r\ddr{r}{E_z} + \left(r^2\w^2\eps\mu - n^2\right)E_z =ik_zr\ddr{r}{(rE_r)} -  nk_zrE_\theta
    \end{equation}

    \TODO{Vérifier que $\vdiv\vrot\v{V} = 0$ en cylindrique.}

    Or comme $\vdiv \vE = i\w\mu\vdiv\vrot\vH = 0$, on a
    \begin{align}
        \vdiv\vE &= \frac{1}{r}\ddr{r}{(rE_r)} + \frac{in}{r}E_\theta + ik_zE_z
        \\
        &=0
        \\
        k_z^2r^2 E_z &= ik_zr\ddr{r}{(rE_r)} - nk_zrE_\theta
    \end{align}

    On obtient donc une équation sur la composante $E_z$:
    \begin{equation}
        r^2 \ddr[2]{r}{E_z} + r\ddr{r}{E_z} + \left(r^2\left(\w^2\eps\mu - k_z^2\right) - n^2\right)E_z = 0
    \end{equation}
    \TODO{Que ce passe t'il si je prend des fonctions de Bessel différentes ? }
    On pose 
    \begin{equation}
        k_3 = \sqrt{\w^2\eps\mu - k_z^2}
    \end{equation}
    Ce nombre est un complexe et par convention $k_3^2 = \w^2\eps\mu - k_z^2$.

    C'est une équation de Bessel (cf \cite[eq (6.80)]{bowman_introduction_1958}), dont des solutions générales sont: soient $(c_1,c_2) \in \CC^2$:
    \TODO{Expliquer que ces choix viennent de la condition limite infini. L'introduire ?}
    \begin{equation}
        E_z = c_1 J_n\left(k_3r\right) + c_2 H_n^{(2)}\left(k_3r\right)
    \end{equation}
    où $J_n$ est la fonction de Bessel du premier type, $H_n^{(2)}$ la fonction de Hankel de deuxième type. 

    On trouve exactement le même résultat pour $H_z$: soient $(c_3,c_4) \in \CC^2$
    \begin{equation}
        H_z = c_3 J_n\left(k_3r\right) + c_4 H_n^{(2)}\left(k_3r\right)
    \end{equation}

    À partir des équations de Maxwell restante, on peut déterminer $E_r,E_\theta,H_r,H_\theta$.
    \begin{equation}
        \left\lbrace
        \begin{matrix}
            -ik_zE_\theta - i\w\mu H_r = -\frac{in}{r}E_z
            \\
            ik_zE_r - i\w\mu H_\theta = \ddr{r}{E_z}
            \\
            -i\w\eps E_r + ik_z H_\theta = \frac{in}{r}H_z
            \\
            -i\w\eps E_\theta - ik_z H_r = -\ddr{r}{H_z}
        \end{matrix}
        \right.
    \end{equation}

    Cela revient à résoudre $\v{Y}= \mat{M}\v{X}$ où la matrice $\mat{M}$ et les vecteurs $\v{X}, \v{Y}$ sont définis tels que
    \begin{equation}
        \mat{M} =
        \begin{bmatrix}
        0 & -ik_z & -i\w\mu & 0 
        \\
        ik_z & 0 & 0 & -i\w\mu
        \\
        -i\w\eps & 0 & 0 & ik_z
        \\
        0 & -i\w\eps & -ik_z & 0
        \end{bmatrix}
        \,
        \v{X} = 
        \begin{bmatrix}
            E_r\\
            E_\theta\\
            H_r\\
            H_\theta
        \end{bmatrix}
        \,
        \v{Y} = 
        \begin{bmatrix}
            -\frac{in}{r}E_z\\
            \ddr{r}{E_z}\\
            \frac{in}{r}H_z\\
            -\ddr{r}{H_z}
        \end{bmatrix}
    \end{equation}

    À condition que $\det(\mat{M}) = (\w^2\eps\mu-k_z^2)^2$ soit non nul, on peut déduire $\v{X}$:

    \begin{equation}
        \begin{bmatrix}
            E_r\\
            E_\theta\\
            H_r\\
            H_\theta
        \end{bmatrix} =
        \frac{1}{k_z^2 - \w^2\eps\mu}
        \begin{bmatrix}
        0 & -ik_z & -i\w\mu & 0 
        \\
        ik_z & 0 & 0 & -i\w\mu
        \\
        -i\w\eps & 0 & 0 & ik_z
        \\
        0 & -i\w\eps & -ik_z & 0
        \end{bmatrix}
        \begin{bmatrix}
            -\frac{in}{r}E_z\\
            \ddr{r}{E_z}\\
            \frac{in}{r}H_z\\
            -\ddr{r}{H_z}
        \end{bmatrix}
    \end{equation}

    On extrait alors $E_\theta, H_\theta$ pour obtenir les champs tangentielles à $\v{e_r}$ en tout point, sachant déjà $E_z, H_z$.

    \begin{align}
        E_\theta &= -\frac{1}{k_3^2}\left(\frac{nk_z}{r}E_z - i\w\mu\ddr{r}{H_z}\right)
        \\
        E_z &= c_1 J_n(k_3 r) + c_2 H_n^{(2)}(k_3 r)
        \\
        -H_z &= -c_3 J_n(k_3 r) - c_4 H_n^{(2)}(k_3 r)
        \\
        H_\theta &= -\frac{1}{k_3^2}\left(-i\w\eps\ddr{r}{E_z} + \frac{nk_z}{r}H_z\right)
    \end{align}

    Ce qui peut s'écrire matriciellement:
    \begin{align}
        \vE_t &= 
        \begin{bmatrix}
            -\frac{nk_z}{rk_3^2}J_n(k_3r) & \frac{i\w\mu}{k_3}J_n'(k_3r)
            \\
            J_n(k_3r) & 0
        \end{bmatrix}
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \begin{bmatrix}
            -\frac{nk_z}{rk_3^2}H_n^{(2)}(k_3r) & \frac{i\w\mu}{k_3}H_n^{(2)}{}'(k_3r)
            \\
            H_n^{(2)}(k_3r) & 0
        \end{bmatrix}
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
        \\
        \v{e_r}\times\vH_t &= 
        \begin{bmatrix}
            0 & -J_n(k_3r)
            \\
            -\frac{i\w\eps}{k_3}J_n'(k_3r) & -\frac{nk_z}{rk_3^2}J_n(k_3r)
        \end{bmatrix}
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \begin{bmatrix}
            0 & -H_n^{(2)}(k_3r)
            \\
            -\frac{i\w\eps}{k_3}H_n^{(2)}{}'(k_3r) & -\frac{nk_z}{rk_3^2}H_n^{(2)}(k_3r)
        \end{bmatrix}
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
    \end{align}

    \newcommand{\mJ}{\mat{J}}
    \newcommand{\mH}{\mat{H}}

    Pour simplifier les notations, on définit les matrices $\mJ_{E},\mH_{E},\mJ_{H},\mH_{H}$ telles que
    \begin{align}
        \vE_t(r) &= \mJ_{E}(r)
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \mH_{E}(r)
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
        \\
        \v{e_r}\times\vH_t(r) &= 
        \mJ_{H}(r)
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \mH_{H}(r)
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
    \end{align}


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


    \subsection{Opérateur d'impédance pour une couche}

        \begin{figure}[!hbt]
            \centering
            \begin{tikzpicture}
                \input{tikz/schema/cylindre_1_couche.tikz}
            \end{tikzpicture}
        \end{figure}


        On applique la relation $\vE_t = 0$ en $r = r_0$.
        \begin{equation}
            \mJ_{E}(r_0)
            \begin{bmatrix}
                c_1 \\
                c_3
            \end{bmatrix}
            =-\mH_{E}(r_0)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
        \end{equation}

        Or par définition des matrices,
        \begin{align}
            \det(\mJ_E(r_0)) &= -\frac{i\w\mu}{k_3}J_n(k_3r_0)J_n'(k_3r_0)
            \\
            \det(\mH_E(r_0)) &= -\frac{i\w\mu}{k_3}H_n^{(2)}(k_3r_0)H_n^{(2)}{}'(k_3r_0)
        \end{align}
        \TODO{Trouver les zéros des Bessels : \url{http://mathworld.wolfram.com/BesselFunctionZeros.html}}

        
        À condition de l'inversibilité de ces deux matrices, on peut donc exprimer certaines constantes $c_i$ en fonction des autres

        Sur la surface extérieur du cylindre ($r=r_1= r_0 + d$), on a donc 
        \begin{align}
            \vE_t &= 
            \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)\right)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
            \\
            \v{e_r}\times\vH_t &= 
            \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0) \right)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
        \end{align}

        Et à condition que $\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)$ soit inversible, l'opérateur d'impédance est:

        \TODO{Inversibilité de $\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)$}

        \begin{align}
            \mZ &= 
            \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)\right)
            \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)\right)^{-1}
            \\
            &=
            \left(\mH_{E}(r_1)\mH_{E}(r_0)^{-1} - \mJ_{E}(r_1)\mJ_{E}(r_0)^{-1}\right)
            \left(\mH_{H}(r_1)\mH_{E}(r_0)^{-1} - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\right)^{-1}
        \end{align}

        Contrairement au plan, les matrices ne commutent pas et on ne peut pas simplifier le résultat.


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


    \subsection{Opérateur d'impédance pour plusieurs couches}

        \begin{figure}[!hbt]
            \centering
            \begin{tikzpicture}
                \input{tikz/schema/cylindre_n_couches.tikz}
            \end{tikzpicture}
        \end{figure}

        On résonne par récursivité: on se ramène à un empilement à une seule couche, avec en $r=r_0$ la relation
        \begin{equation}
            \begin{bmatrix}
                E_\theta(r_0)\\
                E_z(r_0)\\
            \end{bmatrix}
            =
            \mat {Z_{d}} 
            \begin{bmatrix}
                -H_z(r_0)\\
                H_\theta(r_0)\\
            \end{bmatrix}
        \end{equation}

        \begin{align}
            \mJ_{E}(r_0)
            \begin{bmatrix}
                c_1 \\
                c_3
            \end{bmatrix}
            +
            \mH_{E}(r_0)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
            &=
            \mat{Z_{d}}
            \left(
                \mJ_{H}(r_0)
                \begin{bmatrix}
                    c_1 \\
                    c_3
                \end{bmatrix}
                +
                \mH_{H}(r_0)
                \begin{bmatrix}
                    c_2 \\
                    c_4
                \end{bmatrix}
            \right)
            \\
            \left( \mJ_{E}(r_0) -  \mZ_d \mJ_{H}(r_0) \right)
            \begin{bmatrix}
                c_1 \\
                c_3
            \end{bmatrix}
            &=
            -\left( \mH_{E}(r_0) -  \mZ_d \mH_{H}(r_0) \right)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
        \end{align}

        On pose 
        \begin{align}
            \mA_J(r_0) &= \mJ_{E}(r_0) -  \mZ_d \mJ_{H}(r_0)
            \\
            \mA_H(r_0) &= \mH_{E}(r_0) -  \mZ_d \mH_{H}(r_0)
        \end{align}

        \TODO{Inversibilité de $\mA_J(r_0), \mA_H(r_0)$.}

        On en déduit directement les champs en $r=r_1=r_0+d$

        \begin{align}
            \vE_t &= 
            \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0)\right)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
            \\
            \v{e_r}\times\vH_t &= 
            \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0) \right)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
        \end{align}

        \TODO{Inversibilité de $\mH_{H}(r_1) - \mJ_{H}(r_1)(\mA_{J}(r_0))^{-1}\mA_{H}(r_0)$.}

        On peut alors conclure sur l'opérateur d'impédance:

        \begin{align}
            \mZ &= 
            \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0)\right)
            \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0)\right)^{-1}
            \\
            &=
            \left(\mH_{E}(r_1)\mA_{H}(r_0)^{-1} - \mJ_{E}(r_1)\mA_{J}(r_0)^{-1}\right)
            \left(\mH_{H}(r_1)\mA_{H}(r_0)^{-1} - \mJ_{H}(r_1)\mA_{J}(r_0)^{-1}\right)^{-1}
        \end{align}