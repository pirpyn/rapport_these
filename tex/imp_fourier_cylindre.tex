


\subsection{Forme générale des solutions pour un cylindre recouvert de matériau homogène isotrope}

On rappelle les formules des opérateurs $\vdiv, \vrot$ en coordonnée cylindrique $(r,\theta,z)$.
\begin{align}
    \vrot \v{V} &= \left(\frac{1}{r}\ddr{\theta}{V_z} - \ddr{z}{V_\theta}\right)\v{e_r} + 
    \left(\ddr{z}{V_r} - \ddr{r}{V_z}\right)\v{e_\theta} +
    \frac{1}{r}\left(\ddr{r}{(rV_\theta)}-\ddr{\theta}{V_r}\right)\v{e_z} 
    \\
    \vdiv \v{V} &= \frac{1}{r}\ddr{r}{(rV_r)}+\frac{1}{r}\ddr{\theta}{V_\theta}+\ddr{z}{V_z}
\end{align}

\newcommand{\mr}{r}
\newcommand{\mt}{\theta}
\newcommand{\mz}{z}

\begin{figure}[!hbt]
    \centering
    \begin{tikzpicture}
        \input{tikz/schema/cylindre.tikz}
    \end{tikzpicture}
\end{figure}

On exprime les équations de Maxwell dans le matériau dans cette base et sans pertes de généralité, on peut réaliser une transformée de Fourier en $z$ par invariance en translation et en $\theta$ par invariance en rotation. Cependant, le multiplicateur de Fourier associé à la coordonnée $\theta$ doit être un entier pour assurer la périodicité. On le note $n$.

\begin{align}
    \vrot \vE &= i\left(\frac{n}{r}E_z - k_zE_\theta\right)\v{e_r} + 
    \left(ik_zE_r - \ddr{r}{E_z}\right)\v{e_\theta} +
    \frac{1}{r}\left(\ddr{r}{(rE_\theta)}-inE_r\right)\v{e_z}
    \\
    &=i\w\mu \vH
\end{align}

On remarque que dans ce cas, la méthode utilisée pour le plan aboutie à une EDO à coefficients non constant de type $r\ddr{r}{X}(r) = M(r)X(r)$.


\TODO{
    Passer en cylindrique. Développer $\vrot \vrot$ et trouver des équations de Bessel pour $E_z$, $H_z$.
    \[
    r^2\ddr[2]{r}{E_z} + r\ddr{r}{E_z} + (r^2 - n^2) E_z = 0
    \]
     Déduire $E_r$,$H_r$,$E_\theta$,$H_\theta$. Trouver $\mat{Z}$
}

On ne peut pas exprimer la solution avec les valeurs et vecteurs propres de la matrice. 
%Nous allons donc trouver une équation de Bessel en développant le système de Maxwell.
On développe le système de Maxwell:

\begin{align}
    \vrot \vrot \vE &= \w^2\eps\mu \vE
    \\
    \vdiv \vE &= 0
\end{align}

\begin{multline}
    \vrot \vrot \vE = \dots\\
    i\left(\frac{n}{r^2}\left(\ddr{r}{(rE_\theta)} - inE_r\right) - k_z\left(ik_zE_r - \ddr{r}{E_z}\right)\right)    \v{e_r} \dots\\ 
    + \left(-k_z\left(\frac{n}{r}E_z - k_zE_\theta\right) -\ddr{r}{}\left(\frac{1}{r}\left(\ddr{r}{(rE_\theta)}-inE_r\right)\right)\right)    \v{e_\theta} \dots\\
    + \frac{1}{r}\left(\ddr{r}{} \left(r\left(ik_zE_r - \ddr{r}{E_z}\right)\right) + n \left(\frac{n}{r}E_z - k_zE_\theta\right)\right) \v{e_z}
\end{multline}

On aboutit au système suivant,
\begin{equation}
    \left\lbrace
    \begin{array}{ccc}
        -\left(\w^2\eps\mu -\frac{n^2}{r^2}  - k_z^2\right)E_r  +i\frac{n}{r^2}\ddr{r}{(rE_\theta)}  +k_z\ddr{r}{E_z} & = & 0\\
        in\ddr{r}{}\left(\frac{E_r}{r}\right) -\left(\w^2\eps\mu - k_z^2\right)E_\theta + \ddr{r}{}\left(\frac{1}{r}\ddr{r}{(rE_\theta)}\right)  - n\frac{k_z}{r}E_z & = & 0\\
        i\frac{k_z}{r}\ddr{r}{(rE_r)}  - n\frac{k_z}{r}E_\theta  -\left(\w^2\eps\mu - \frac{n^2}{r^2} \right)E_z - \frac{1}{r}\ddr{r}{}\left(r\ddr{r}{E_z}\right) & = & 0
    \end{array}
    \right.
\end{equation}

Comme l'on cherche $\vE_t, \vH_t$, on cherche une équation différentielle à résoudre sur $E_z$, puis on en déduira $\vE_t$.

De la troisième  équation, on trouve pour $r\not=0$
\begin{equation}
r^2 \ddr[2]{r}{E_z} + r\ddr{r}{E_z} + \left(r^2\w^2\eps\mu - n^2\right)E_z =ik_zr\ddr{r}{(rE_r)} -  nk_zrE_\theta
\end{equation}

\TODO{Vérifier que $\vdiv\vrot\v{V} = 0$ en cylindrique.}

Or comme $\vdiv \vE = i\w\mu\vdiv\vrot\vH = 0$, on a
\begin{align}
    \vdiv\vE &= \frac{1}{r}\ddr{r}{(rE_r)} + \frac{in}{r}E_\theta + ik_zE_z
    \\
    &=0
    \\
    k_z^2r^2 E_z &= ik_zr\ddr{r}{(rE_r)} - nk_zrE_\theta
\end{align}

On obtient donc une équation sur la composante $E_z$:
\begin{equation}
    r^2 \ddr[2]{r}{E_z} + r\ddr{r}{E_z} + \left(r^2\left(\w^2\eps\mu - k_z^2\right) - n^2\right)E_z = 0
\end{equation}
\TODO{Que ce passe t'il si je prend des fonctions de Bessel différentes ? }
On pose 
\begin{equation}
    k_3 = \sqrt{\w^2\eps\mu - k_z^2}
\end{equation}
Ce nombre est un complexe et par convention $k_3^2 = \w^2\eps\mu - k_z^2$.

C'est une équation de Bessel (cf \cite[eq (6.80)]{bowman_introduction_1958}), dont des solutions générales sont: soient $(c_1,c_2) \in \CC^2$:
\TODO{Expliquer que ces choix viennent de la condition limite infini. L'introduire ?}
\begin{equation}
    E_z = c_1 J_n\left(k_3r\right) + c_2 H_n^{(2)}\left(k_3r\right)
\end{equation}
où $J_n$ est la fonction de Bessel du premier type, $H_n^{(2)}$ la fonction de Hankel de deuxième type. 

On trouve exactement le même résultat pour $H_z$: soient $(c_3,c_4) \in \CC^2$
\begin{equation}
    H_z = c_3 J_n\left(k_3r\right) + c_4 H_n^{(2)}\left(k_3r\right)
\end{equation}

À partir des équations de Maxwell restante, on peut déterminer $E_r,E_\theta,H_r,H_\theta$.
\begin{equation}
    \left\lbrace
    \begin{matrix}
        -ik_zE_\theta - i\w\mu H_r = -\frac{in}{r}E_z
        \\
        ik_zE_r - i\w\mu H_\theta = \ddr{r}{E_z}
        \\
        -i\w\eps E_r + ik_z H_\theta = \frac{in}{r}H_z
        \\
        -i\w\eps E_\theta - ik_z H_r = -\ddr{r}{H_z}
    \end{matrix}
    \right.
\end{equation}

Cela revient à résoudre $\v{Y}= \mat{M}\v{X}$ où la matrice $\mat{M}$ et les vecteurs $\v{X}, \v{Y}$ sont définis tels que
\begin{equation}
    \mat{M} =
    \begin{bmatrix}
    0 & -ik_z & -i\w\mu & 0 
    \\
    ik_z & 0 & 0 & -i\w\mu
    \\
    -i\w\eps & 0 & 0 & ik_z
    \\
    0 & -i\w\eps & -ik_z & 0
    \end{bmatrix}
    \,
    \v{X} = 
    \begin{bmatrix}
        E_r\\
        E_\theta\\
        H_r\\
        H_\theta
    \end{bmatrix}
    \,
    \v{Y} = 
    \begin{bmatrix}
        -\frac{in}{r}E_z\\
        \ddr{r}{E_z}\\
        \frac{in}{r}H_z\\
        -\ddr{r}{H_z}
    \end{bmatrix}
\end{equation}

À condition que $\det(\mat{M}) = (\w^2\eps\mu-k_z^2)^4$ soit non nul, on peut déduire $\vE_t$ et $\v{e_r}\times \vH_t$:

\begin{equation}
    \begin{bmatrix}
        E_r\\
        E_\theta\\
        H_r\\
        H_\theta
    \end{bmatrix} =
    \frac{1}{k_z^2 - \w^2\eps\mu}
    \begin{bmatrix}
    0 & -ik_z & -i\w\mu & 0 
    \\
    ik_z & 0 & 0 & -i\w\mu
    \\
    -i\w\eps & 0 & 0 & ik_z
    \\
    0 & -i\w\eps & -ik_z & 0
    \end{bmatrix}
    \begin{bmatrix}
        -\frac{in}{r}E_z\\
        \ddr{r}{E_z}\\
        \frac{in}{r}H_z\\
        -\ddr{r}{H_z}
    \end{bmatrix}
\end{equation}

\begin{align}
    E_\theta &= -\frac{1}{k_3^2}\left(\frac{nk_z}{r}E_z - i\w\mu\ddr{r}{H_z}\right)
    \\
    E_z &= c_1 J_n(k_3 r) + c_2 H_n^{(2)}(k_3 r)
\end{align}

\begin{align}
    -H_z &= -c_3 J_n(k_3 r) - c_4 H_n^{(2)}(k_3 r)
    \\
    H_\theta &= -\frac{1}{k_3^2}\left(-i\w\eps\ddr{r}{E_z} + \frac{nk_z}{r}H_z\right)
\end{align}

\begin{align}
\vE_t &= 
\begin{bmatrix}
    -\frac{nk_z}{rk_3^2}J_n(k_3r) & \frac{i\w\mu}{k_3}J_n'(k_3r)
    \\
    J_n(k_3r) & 0
\end{bmatrix}
\begin{bmatrix}
c_1 \\
c_3
\end{bmatrix}
+
\begin{bmatrix}
    -\frac{nk_z}{rk_3^2}H_n^{(2)}(k_3r) & \frac{i\w\mu}{k_3}H_n^{(2)}{}'(k_3r)
    \\
    H_n^{(2)}(k_3r) & 0
\end{bmatrix}
\begin{bmatrix}
c_2 \\
c_4
\end{bmatrix}
\\
\v{e_r}\times\vH_t &= 
\begin{bmatrix}
    -J_n(k_3r) & 0
    \\
    -\frac{i\w\eps}{k_3^2}J_n'(k_3r) & -\frac{nk_z}{rk_3^2}J_n(k_3r)
\end{bmatrix}
\begin{bmatrix}
c_1 \\
c_3
\end{bmatrix}
+
\begin{bmatrix}
    -H_n^{(2)}(k_3r) & 0
    \\
    -\frac{i\w\eps}{k_3^2}H_n^{(2)}{}'(k_3r) & -\frac{nk_z}{rk_3^2}H_n^{(2)}(k_3r)
\end{bmatrix}
\begin{bmatrix}
c_2 \\
c_4
\end{bmatrix}
\end{align}