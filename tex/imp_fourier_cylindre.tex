\section{Cas d'un objet cylindrique}

    % On rappelle les formules des opérateurs $\vdiv, \vrot$ en coordonnée cylindrique $(r,\theta,z)$.
    % \begin{align}
    %     \vrot \v{V} &= \left(\frac{1}{r}\ddr{\theta}{V_z} - \ddr{z}{V_\theta}\right)\v{e_r} + 
    %     \left(\ddr{z}{V_r} - \ddr{r}{V_z}\right)\v{e_\theta} +
    %     \frac{1}{r}\left(\ddr{r}{(rV_\theta)}-\ddr{\theta}{V_r}\right)\v{e_z} 
    %     \\
    %     \vdiv \v{V} &= \frac{1}{r}\ddr{r}{(rV_r)}+\frac{1}{r}\ddr{\theta}{V_\theta}+\ddr{z}{V_z}
    %     \\
    %     \vgrad f &= \ddr{r}{f}\v{e_r}
    %     +\frac{1}{r}\ddr{\theta}{f}\v{e_\theta} + \ddr{z}{f}\v{e_z}
    % \end{align}

    \begin{figure}[!hbt]
        \centering
        \begin{tikzpicture}
            \input{tikz/schema/cylindre_1_couche.tikz}
        \end{tikzpicture}
    \end{figure}

    On exprime les équations de Maxwell dans le matériau dans la base cylindrique et sans pertes de généralité, on peut réaliser une transformée de Fourier en $z$ par invariance en translation et en $\theta$ par invariance en rotation. Cependant, le multiplicateur de Fourier associé à la coordonnée $\theta$ doit être un entier pour assurer la périodicité. On le note $n$.

    \begin{equation}
        \vE(r,\theta,z) = \frac{1}{2\pi}\sum_{i=-\infty}^{\infty}\int_{\RR} e^{i(n \theta + k_z z )}\hat{\vE} (r,n,k_z) \dd{k_z}
    \end{equation}

    \begin{prop}
        Soit
        \begin{equation}
            k_3 = \sqrt{\w^2\eps\mu - k_z^2}
        \end{equation}
        et $J_n$ et $H_n^{(2)}$ des solutions de l'équation de Bessel d'ordre $n$.
        
        Alors $\exists (c_i)_{i<4} \in \CC^4$
        \begin{subequations}
            \begin{align}
                \hat{E_z}(r,n,k_z) &= c_1 J_n\left(k_3r\right) + c_2 H_n^{(2)}\left(k_3r\right)
                \\
                \hat{H_z}(r,n,k_z) &= c_3 J_n\left(k_3r\right) + c_4 H_n^{(2)}\left(k_3r\right)
            \end{align}
        \end{subequations}
    \end{prop}

    \begin{proof}

        On peut simplifier les opérateurs différentiels:

        \begin{align}
            \vrot \hat \vE(r,n,k_z) &= i\left(\frac{n}{r}\hat{E_z} - k_z\hat{E_\theta}\right)\v{e_r} + 
            \left(ik_z\hat{E_r} - \ddr{r}{\hat{E_z}}\right)\v{e_\theta} +
            \frac{1}{r}\left(\ddr{r}{(r\hat{E_\theta})}-in\hat{E_r}\right)\v{e_z}
            \\
            &=i\w\mu \hat \vH(r,n,k_z)
        \end{align}

        On remarque que la méthode utilisée pour le plan aboutie à une équation différentielle à coefficients non constant de type $r\ddr{r}{X}(r,n,k_z) = M(r,n,k_z)X(r,n,k_z)$. On ne peut pas exprimer la solution avec les valeurs et vecteurs propres de la matrice. 
        %Nous allons donc trouver une équation de Bessel en développant le système de Maxwell.
        On développe le système de Maxwell:

        \begin{align}
            \vrot \vrot \hat \vE &= \w^2\eps\mu \hat \vE
            \\
            \vdiv \hat \vE &= 0
        \end{align}

        \begin{multline}
            \vrot \vrot \hat \vE = \dots\\
            i\left(\frac{n}{r^2}\left(\ddr{r}{(r\hat{E_\theta})} - in\hat{E_r}\right) - k_z\left(ik_z\hat{E_r} - \ddr{r}{\hat{E_z}}\right)\right)    \v{e_r} \dots\\ 
            + \left(-k_z\left(\frac{n}{r}\hat{E_z} - k_z\hat{E_\theta}\right) -\ddr{r}{}\left(\frac{1}{r}\left(\ddr{r}{(r\hat{E_\theta})}-in\hat{E_r}\right)\right)\right)    \v{e_\theta} \dots\\
            + \frac{1}{r}\left(\ddr{r}{} \left(r\left(ik_z\hat{E_r} - \ddr{r}{\hat{E_z}}\right)\right) + n \left(\frac{n}{r}\hat{E_z} - k_z\hat{E_\theta}\right)\right) \v{e_z}
        \end{multline}

        On aboutit au système suivant
        \begin{equation}
            \left\lbrace
            \begin{array}{ccc}
                -\left(\w^2\eps\mu -\frac{n^2}{r^2}  - k_z^2\right)\hat{E_r}  +i\frac{n}{r^2}\ddr{r}{(r\hat{E_\theta})}  +k_z\ddr{r}{\hat{E_z}} & = & 0\\
                in\ddr{r}{}\left(\frac{\hat{E_r}}{r}\right) -\left(\w^2\eps\mu - k_z^2\right)\hat{E_\theta} + \ddr{r}{}\left(\frac{1}{r}\ddr{r}{(r\hat{E_\theta})}\right)  - n\frac{k_z}{r}\hat{E_z} & = & 0\\
                i\frac{k_z}{r}\ddr{r}{(r\hat{E_r})}  - n\frac{k_z}{r}\hat{E_\theta}  -\left(\w^2\eps\mu - \frac{n^2}{r^2} \right)\hat{E_z} - \frac{1}{r}\ddr{r}{}\left(r\ddr{r}{\hat{E_z}}\right) & = & 0
            \end{array}
            \right.
        \end{equation}

        Comme l'on cherche $\hat \vE_t, \hat \vH_t$, on remarque que les 2\ieme composantes des équations de Maxwell permettent de déduire $\hat\vE_t, \hat\vH_t$ de $ \hat E_z, \hat H_z$

        De la troisième  équation, on trouve pour $r\not=0$
        \begin{equation}
        r^2 \ddr[2]{r}{\hat{E_z}} + r\ddr{r}{\hat{E_z}} + \left(r^2\w^2\eps\mu - n^2\right)\hat{E_z} =ik_zr\ddr{r}{(r\hat{E_r})} -  nk_zr\hat{E_\theta}
        \end{equation}

        Or comme $\vdiv \hat \vE = i\w\mu\vdiv\vrot \hat \vH = 0$, on a
        \begin{align}
            \vdiv\hat \vE &= \frac{1}{r}\ddr{r}{(r\hat{E_r})} + \frac{in}{r}\hat{E_\theta} + ik_z\hat{E_z}
            \\
            &=0
            \\
            k_z^2r^2 \hat{E_z} &= ik_zr\ddr{r}{(r\hat{E_r})} - nk_zr\hat{E_\theta}
        \end{align}

        On obtient donc sur la composante $\hat{E_z}$:
        \begin{equation}
            r^2 \ddr[2]{r}{\hat{E_z}} + r\ddr{r}{\hat{E_z}} + \left(r^2\left(\w^2\eps\mu - k_z^2\right) - n^2\right)\hat{E_z} = 0
        \end{equation}

        C'est une équation de Bessel (cf \cite[eq (6.80)]{bowman_introduction_1958}), dont des solutions générales sont: soient $(c_1,c_2) \in \CC^2$:
       \begin{equation}
            \hat{E_z}(r,n,k_z) = c_1 J_n\left(k_3r\right) + c_2 H_n^{(2)}\left(k_3r\right)
        \end{equation}
        où $J_n$ est la fonction de Bessel du premier type, $H_n^{(2)}$ la fonction de Hankel de deuxième type. On sait que l'on peut prendre n'importe quel couple de fonctions de Bessel (cf \eqref{eq:annex:bessel:equiv_bessel}), on choisit ce dernier car les $J_n$ sont régulières et les $H_n$ évoluent en $\frac{1}{\sqrt{r}}$ à l'infini, donc ce choix est adapté à une décomposition en une onde incidente partout définie et une onde réfléchie décroissante à l'infini.

        On trouve exactement le même résultat pour $\hat{H_z}$: soient $(c_3,c_4) \in \CC^2$
        \begin{equation}
            \hat{H_z}(r,n,k_z) = c_3 J_n\left(k_3r\right) + c_4 H_n^{(2)}\left(k_3r\right)
        \end{equation}
    \end{proof}

    À partir des équations de Maxwell restantes, on peut déterminer $\hat{E_r},\hat{E_\theta},\hat{H_r},\hat{H_\theta}$.
    \begin{equation}
        \left\lbrace
        \begin{matrix}
            -ik_z\hat{E_\theta} - i\w\mu \hat{H_r} = -\frac{in}{r}\hat{E_z}
            \\
            ik_z\hat{E_r} - i\w\mu \hat{H_\theta} = \ddr{r}{\hat{E_z}}
            \\
            -i\w\eps \hat{E_r} + ik_z \hat{H_\theta} = \frac{in}{r}\hat{H_z}
            \\
            -i\w\eps \hat{E_\theta} - ik_z \hat{H_r} = -\ddr{r}{\hat{H_z}}
        \end{matrix}
        \right.
    \end{equation}

    Cela revient à résoudre $\v{Y} = \mat{M}\v{X}$ où la matrice $\mat{M}$ et les vecteurs $\v{X}, \v{Y}$ sont définis tels que
    \begin{equation}
        \mat{M} =
        \begin{bmatrix}
        0 & -ik_z & -i\w\mu & 0 
        \\
        ik_z & 0 & 0 & -i\w\mu
        \\
        -i\w\eps & 0 & 0 & ik_z
        \\
        0 & -i\w\eps & -ik_z & 0
        \end{bmatrix}
        \,
        \v{X} = 
        \begin{bmatrix}
            \hat{E_r}(r,n,k_z)\\
            \hat{E_\theta}(r,n,k_z)\\
            \hat{H_r}(r,n,k_z)\\
            \hat{H_\theta}(r,n,k_z)
        \end{bmatrix}
        \,
        \v{Y} = 
        \begin{bmatrix}
            -\frac{in}{r}\hat{E_z}\\
            \ddr{r}{\hat{E_z}}\\
            \frac{in}{r}\hat{H_z}\\
            -\ddr{r}{\hat{H_z}}
        \end{bmatrix}
    \end{equation}

    À condition que $\det(\mat{M}) = (\w^2\eps\mu-k_z^2)^2$ soit non nul, on peut déduire $\v{X}$:

    \begin{equation}
        \begin{bmatrix}
            \hat{E_r}(r,n,k_z)\\
            \hat{E_\theta}(r,n,k_z)\\
            \hat{H_r}(r,n,k_z)\\
            \hat{H_\theta}(r,n,k_z)
        \end{bmatrix} =
        \frac{1}{k_z^2 - \w^2\eps\mu}
        \begin{bmatrix}
        0 & -ik_z & -i\w\mu & 0 
        \\
        ik_z & 0 & 0 & -i\w\mu
        \\
        -i\w\eps & 0 & 0 & ik_z
        \\
        0 & -i\w\eps & -ik_z & 0
        \end{bmatrix}
        \begin{bmatrix}
            -\frac{in}{r}\hat{E_z}\\
            \ddr{r}{\hat{E_z}}\\
            \frac{in}{r}\hat{H_z}\\
            -\ddr{r}{\hat{H_z}}
        \end{bmatrix}
    \end{equation}

    On extrait alors $\hat{E_\theta}, \hat{H_\theta}$ pour obtenir les champs tangentielles à $\v{e_r}$ en tout point, sachant déjà $\hat{E_z}, \hat{H_z}$.

    \begin{align}
        \hat{E_\theta} &= -\frac{1}{k_3^2}\left(\frac{nk_z}{r}\hat{E_z} + i\w\mu\ddr{r}{\hat{H_z}}\right)
        \\
        \hat{E_z} &= c_1 J_n(k_3 r) + c_2 H_n^{(2)}(k_3 r)
        \\
        -\hat{H_z} &= -c_3 J_n(k_3 r) - c_4 H_n^{(2)}(k_3 r)
        \\
        \hat{H_\theta} &= \frac{1}{k_3^2}\left(i\w\eps\ddr{r}{\hat{E_z}} - \frac{nk_z}{r}\hat{H_z}\right)
    \end{align}

    On dérive les fonctions de Bessel:

   \begin{align}
        \hat{E_\theta} &= -\frac{nk_z}{rk_3^2}\left(c_1J_n(k_3r) + c_2 H_n^{(2)}(k_3r)\right) - \frac{i\w\mu}{k_3}\left(c_3J_n'(k_3r) + c_4 H_n^{(2)}{}'(k_3r)\right)
        \\
        \hat{E_z} &= c_1 J_n(k_3 r) + c_2 H_n^{(2)}(k_3 r)
        \\
        -\hat{H_z} &= -c_3 J_n(k_3 r) - c_4 H_n^{(2)}(k_3 r)
        \\
        \hat{H_\theta} &= \frac{i\w\eps}{k_3}\left(c_1J_n'(k_3r) + c_2 H_n^{(2)}{}'(k_3r)\right) - \frac{nk_z}{rk_3^2}\left(c_3J_n(k_3r) + c_4 H_n^{(2)}(k_3r)\right)
    \end{align}

    Ce qui peut s'écrire matriciellement:
    \begin{align}
        \hat \vE_t(r,n,k_z) &= 
        \begin{bmatrix}
            -\frac{nk_z}{rk_3^2}J_n(k_3r) & -\frac{i\w\mu}{k_3}J_n'(k_3r)
            \\
            J_n(k_3r) & 0
        \end{bmatrix}
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \begin{bmatrix}
            -\frac{nk_z}{rk_3^2}H_n^{(2)}(k_3r) & -\frac{i\w\mu}{k_3}H_n^{(2)}{}'(k_3r)
            \\
            H_n^{(2)}(k_3r) & 0
        \end{bmatrix}
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
        \\
        \v{e_r}\times\hat \vH_t(r,n,k_z) &= 
        \begin{bmatrix}
            0 & -J_n(k_3r)
            \\
            \frac{i\w\eps}{k_3}J_n'(k_3r) & -\frac{nk_z}{rk_3^2}J_n(k_3r)
        \end{bmatrix}
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \begin{bmatrix}
            0 & -H_n^{(2)}(k_3r)
            \\
            \frac{i\w\eps}{k_3}H_n^{(2)}{}'(k_3r) & -\frac{nk_z}{rk_3^2}H_n^{(2)}(k_3r)
        \end{bmatrix}
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
    \end{align}

    \newcommand{\mJ}{\mat{J}}
    \newcommand{\mH}{\mat{H}}

    Pour simplifier les notations, on définit les matrices $\mJ_{E},\mH_{E},\mJ_{H},\mH_{H}$ telles que
    \begin{align}
        \hat \vE_t(r,n,k_z) &= \mJ_{E}(r)
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \mH_{E}(r)
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
        \\
        \v{e_r}\times\hat \vH_t(r,n,k_z) &= 
        \mJ_{H}(r)
        \begin{bmatrix}
            c_1 \\
            c_3
        \end{bmatrix}
        +
        \mH_{H}(r)
        \begin{bmatrix}
            c_2 \\
            c_4
        \end{bmatrix}
    \end{align}


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


    \subsection{Opérateur d'impédance pour une couche}

        On applique la relation $\vE_t(r_0,\theta,z) = 0$ équivalente à $\hat \vE(r_0,n,k_z) = 0$.
        \begin{equation}
            \mJ_{E}(r_0)
            \begin{bmatrix}
                c_1 \\
                c_3
            \end{bmatrix}
            =-\mH_{E}(r_0)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
        \end{equation}

        Or par définition des matrices,
        \begin{align}
            \det(\mJ_E(r_0)) &= -\frac{i\w\mu}{k_3}J_n(k_3r_0)J_n'(k_3r_0)
            \\
            \det(\mH_E(r_0)) &= -\frac{i\w\mu}{k_3}H_n^{(2)}(k_3r_0)H_n^{(2)}{}'(k_3r_0)
        \end{align}
        \TODO{Trouver les zéros des Bessels : \url{http://mathworld.wolfram.com/BesselFunctionZeros.html}}

        
        À condition de l'inversibilité de ces deux matrices, on peut donc exprimer certaines constantes $c_i$ en fonction des autres

        Sur la surface extérieur du cylindre ($r=r_1= r_0 + d$), on a donc 
        \begin{align}
            \hat \vE_t(r_1,n,k_z) &= 
            \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)\right)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
            \\
            \v{e_r}\times \hat \vH_t(r_1,n,k_z) &= 
            \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0) \right)
            \begin{bmatrix}
                c_2 \\
                c_4
            \end{bmatrix}
        \end{align}

        Et à condition que $\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)$ soit inversible, l'opérateur d'impédance est:

        \TODO{Inversibilité de $\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)$}

        \begin{align}
            \hat \mZ &= 
            \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)\right)
            \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\mH_{E}(r_0)\right)^{-1}
            \\
            &=
            \left(\mH_{E}(r_1)\mH_{E}(r_0)^{-1} - \mJ_{E}(r_1)\mJ_{E}(r_0)^{-1}\right)
            \left(\mH_{H}(r_1)\mH_{E}(r_0)^{-1} - \mJ_{H}(r_1)\mJ_{E}(r_0)^{-1}\right)^{-1}
        \end{align}

        Contrairement au plan, les matrices ne commutent pas et on ne peut pas simplifier le résultat.


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


    \subsection{Opérateur d'impédance pour plusieurs couches}

        \begin{figure}[!hbt]
            \centering
            \begin{tikzpicture}
                \input{tikz/schema/cylindre_n_couches.tikz}
            \end{tikzpicture}
        \end{figure}

        Soit $r_m$ le rayon de la couche $m$, $r_m = r_0 +\sum_{i=1}^{m} d_{i}$. 

        Pour chaque couche caractérisée par $(\eps_m,\mu_m,d_m)$, on définit:

        \begin{align}
            k_{3m} &= \sqrt{w^2\eps_m\mu_m - k_z^2}
            \\
            \mJ_{Em}(r) &= 
                \begin{bmatrix}
                    -\frac{nk_z}{rk_{3m}^2}J_n(k_{3m}r) & -\frac{i\w\mu_m}{k_{3m}}J_n'(k_{3m}r)
                    \\
                    J_n(k_{3m}r) & 0
                \end{bmatrix}
            \\
            \mH_{Em}(r) &= 
                \begin{bmatrix}
                    -\frac{nk_z}{rk_{3m}^2}H_n^{(2)}(k_{3m}r) & -\frac{i\w\mu_m}{k_{3m}}H_n^{(2)}{}'(k_{3m}r)
                    \\
                    H_n^{(2)}(k_{3m}r) & 0
                \end{bmatrix}
            \\
            \mJ_{Hm}(r) &= 
                \begin{bmatrix}
                    0 & -J_n(k_{3m}r)
                    \\
                    \frac{i\w\eps_m}{k_{3m}}J_n'(k_{3m}r) & -\frac{nk_z}{rk_{3m}^2}J_n(k_{3m}r)
                \end{bmatrix}
            \\
            \mH_{Hm}(r) &= 
                \begin{bmatrix}
                    0 & -H_n^{(2)}(k_{3m}r)
                    \\
                    \frac{i\w\eps_m}{k_{m3}}H_n^{(2)}{}'(k_{3m}r) & -\frac{nk_z}{rk_{3m}^2}H_n^{(2)}(k_{3m}r)
                \end{bmatrix}
            \\
            \mA_{Em}(r) &= \mJ_{Em}(r) -  \mZ_{m-1} \mJ_{Hm}(r)
            \\
            \mA_{Hm}(r) &= \mH_{Em}(r) -  \mZ_{m-1} \mH_{Hm}(r)
        \end{align}


        On définit pour chaque interface, le symbole $\hat \mZ_m$ tel que 
        \begin{equation}
            \hat \vE_t(r_m,n,k_z) = \hat \mZ_m(n,k_z) \left(\v{e_r} \pvect \hat \vH_t(r_m,n,k_z)\right)
        \end{equation}

        On cherche alors le symbole $\hat \mZ_n(n,k_z)$  de la couche la moins profonde tel que 
        \begin{equation}
            \hat \vE_t(r_n,k_x,k_y) = \hat \mZ_n (n,k_z) \left(\v{e_r} \pvect \hat \vH_t(r_n,n,k_z)\right)
        \end{equation}

        \begin{thm}
            Soit $\hat \mZ_0(n,k_z) = \mat{0}_{\mathcal{M}_2(\CC)}$.

            Si pour tout $0 < m < n$
            \TODO{Mettre conditions à vérifier}
            Alors le symbole $\hat \mZ_n$ est défini par la relation de récurrence : 
            \begin{multline}
                \mZ_m = \left(\mH_{Em}(r_m)\mA_{Hm}(r_{m-1})^{-1} - \mJ_{Em}(r_m)\mA_{Jm}(r_{m-1})^{-1}\right) \\
                        \left(\mH_{Hm}(r_m)\mA_{Hm}(r_{m-1})^{-1} - \mJ_{Hm}(r_m)\mA_{Jm}(r_{m-1})^{-1}\right)^{-1}
            \end{multline}
        \end{thm}

        \begin{proof}

            On résonne par récursivité: on se ramène à un empilement à une seule couche, avec en $r=r_0$ la relation
            \begin{equation}
                \begin{bmatrix}
                    \hat{E_\theta}(r_0)\\
                    \hat{E_z}(r_0)\\
                \end{bmatrix}
                =
                \hat \mZ_m
                \begin{bmatrix}
                    -\hat{H_z}(r_0)\\
                    \hat{H_\theta}(r_0)\\
                \end{bmatrix}
            \end{equation}

            \begin{align}
                \mJ_{E}(r_0)
                \begin{bmatrix}
                    c_1 \\
                    c_3
                \end{bmatrix}
                +
                \mH_{E}(r_0)
                \begin{bmatrix}
                    c_2 \\
                    c_4
                \end{bmatrix}
                &=
                \hat \mZ_m
                \left(
                    \mJ_{H}(r_0)
                    \begin{bmatrix}
                        c_1 \\
                        c_3
                    \end{bmatrix}
                    +
                    \mH_{H}(r_0)
                    \begin{bmatrix}
                        c_2 \\
                        c_4
                    \end{bmatrix}
                \right)
                \\
                \left( \mJ_{E}(r_0) -  \mZ_d \mJ_{H}(r_0) \right)
                \begin{bmatrix}
                    c_1 \\
                    c_3
                \end{bmatrix}
                &=
                -\left( \mH_{E}(r_0) -  \mZ_d \mH_{H}(r_0) \right)
                \begin{bmatrix}
                    c_2 \\
                    c_4
                \end{bmatrix}
            \end{align}

            On pose 
            \begin{align}
                \mA_J(r_0) &= \mJ_{E}(r_0) -  \mZ_d \mJ_{H}(r_0)
                \\
                \mA_H(r_0) &= \mH_{E}(r_0) -  \mZ_d \mH_{H}(r_0)
            \end{align}

            \TODO{Inversibilité de $\mA_J(r_0), \mA_H(r_0)$.}

            On en déduit directement les champs en $r=r_1=r_0+d$

            \begin{align}
                \vE_t &= 
                \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0)\right)
                \begin{bmatrix}
                    c_2 \\
                    c_4
                \end{bmatrix}
                \\
                \v{e_r}\times\vH_t &= 
                \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0) \right)
                \begin{bmatrix}
                    c_2 \\
                    c_4
                \end{bmatrix}
            \end{align}

            \TODO{Inversibilité de $\mH_{H}(r_1) - \mJ_{H}(r_1)(\mA_{J}(r_0))^{-1}\mA_{H}(r_0)$.}

            On peut alors conclure sur le symbole

            \begin{align}
                \hat \mZ_{m+1} &= 
                \left(\mH_{E}(r_1) - \mJ_{E}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0)\right)
                \left(\mH_{H}(r_1) - \mJ_{H}(r_1)\mA_{J}(r_0)^{-1}\mA_{H}(r_0)\right)^{-1}
                \\
                &=
                \left(\mH_{E}(r_1)\mA_{H}(r_0)^{-1} - \mJ_{E}(r_1)\mA_{J}(r_0)^{-1}\right)
                \left(\mH_{H}(r_1)\mA_{H}(r_0)^{-1} - \mJ_{H}(r_1)\mA_{J}(r_0)^{-1}\right)^{-1}
            \end{align}

        \end{proof}

    \subsection{Applications numérique}

        La figure \ref{fig:imp_fourier:cylindre:hoppe} permet de vérifier les résultats de \cite[p.~62]{hoppe_impedance_1995} pour une couche de matériau sans perte.

        \TODO{Expliquer pourquoi on prendre des valeurs continues de $n$ et non discrètes}

        \pgfplotstableread[col sep=semicolon]{tikz/csv/impedance_cylindre_1_couche_hoppe_p62.csv}{\hoppeimpcylindre}
        \begin{figure}[!hbt]
            \centering
            \begin{tikzpicture}[scale=1]
                \begin{axis}[
                        title={},
                        ylabel={$\Im(Z)$},
                        xlabel={$k_t\slash k_0$},
                        mark repeat=20,
                        legend pos=outer north east
                    ]
                    \legend{TM,TE}
                    \addplot [blue,thick,mark=*] table [x={s}, y={imag(z.tm)}] {\hoppeimpcylindre};
                    \addplot [red,thick,mark=x] table [x={s}, y={imag(z.te)}] {\hoppeimpcylindre};
                \end{axis}
            \end{tikzpicture}
            \caption{$\eps = 6, \mu = 1, r_0 = 0.0300\text{m}, d=0.0225\text{m}, f=1\text{GHz}$}
            \label{fig:imp_fourier:cylindre:hoppe}
        \end{figure}

        \TODO{Mettre un rayon grand}