\section{Analyse de Fourier de l'opérateur d'impédance}
Soit $\OO$ un domaine fermé, bornée, de frontière régulière. Supposons que ces champs soient $L^2$ en espace et en temps: $(\vE(\v{x},t),\vH(\v{x},t)) \in L^2(\OO \times \RR_+) \cap L^2(\OO^c\times\RR_+)$ et vérifient les équations de Maxwell:
\begin{equation}
    \left\lbrace 
    \begin{matrix}
    \vrot \vE = \mu \ddr{t}{\vH} \\
    \vrot \vH = -\eps \ddr{t}{\vE}
    \end{matrix}
    \right.
\end{equation}

Puisque ces champs $\vE(\v{x},t),\vH(\v{x},t)$ sont $L^2$, on peut définir leurs transformées de Fourier $\hat{\vE}(\v{k},\w), \hat{\vH}(\v{k},\w)$ (\cite[Théorème de Plancherel, p.~153]{yosida_functional_1995}) telle que

\begin{equation}
    \hat{\vE} (\v{k},\w) = \frac{1}{\sqrt{2\pi}^n}\int_{\RR^n} e^{-i(\v{k} \cdot \v{x}+\w t)}\vE(\v{x},t) dxdt\,, \quad dx = \prod\limits_{i=1}^n dx_i
\end{equation}

La méthode pour trouver une expression de l'opérateur d'impédance est la suivante.
\begin{itemize}
\item Faire une transformée de Fourier partielle des champs, dépendante de la géométrie.
\item Réécrire le système d'équation de Maxwell simplifié.
\item Obtenir des EDO simple à résoudre sur les composantes des champs.
\item Utiliser les conditions limites pour les déduire 
\item En déduire l'opérateur d'impédance en Fourier.
\end{itemize}

Dans ce qui suit, on réalise au moins une transformée partielle en temps. La variable de Fourier associée est $\w$, et donc l'opérateur $\ddr{t}{~}$ est remplacé par $i\w$.

\begin{tcolorbox}
On ne différencie pas les champs $\vE,\vH$ de leurs transformées de Fourier $\hat \vE, \hat \vH$.
\end{tcolorbox}

On va donc utiliser le système d'équations de Maxwell harmonique:

\begin{equation}
    \left\lbrace 
    \begin{matrix}
    \vrot \vE = i \omega \mu \vH \\
    \vrot \vH = -i \omega \eps \vE
    \end{matrix}
    \right.
    \label{eq:imp_fourier:intro:maxwell_harmonique}
\end{equation}


\subsection{Forme générale des solutions pour un plan infini}

% Ce cas est très bien documenté (\cite{senior_approximate_1995},\cite{hoppe_impedance_1995}) et pose la méthodologie à adopter pour les objets courbes. 

Dans un premier temps, on peut sans perte de généralités faire une rotation du repère pour avoir le plan orthogonal à $\v e_3$. Comme il est infini dans les directions $\v e_1, \v e_2$ et que le matériau est homogène isotrope, on utilise la transformée partielle en $x_1, x_2$ seulement.

\renewcommand{\x}{{\v e_1}}
\renewcommand{\y}{{\v e_2}}
\renewcommand{\z}{{\v e_3}}
\renewcommand{\peps}{{\eps}}
\renewcommand{\pmu}{{\mu}}
\begin{figure}[h!]
\centering
\begin{tikzpicture}
\input{tikz/schema/plan.tikz}
\end{tikzpicture}
\end{figure}

En explicitant par composante l'opérateur $\vrot$ , le problème \eqref{eq:imp_fourier:intro:maxwell_harmonique} s'écrit  
\begin{align*}
    \left\lbrace 
    \begin{matrix}
    ik_2 E_3  - \ddr{x_3}{E_ 2} = i \w \mu H_1 \\
    \ddr{x_3}{E_1} - ik_1 E_3 = i\w \mu H_2 \\
    ik_1 E_2 - ik_2 E_1 = i\w \mu H_3 \\
    \end{matrix}
    \right. \quad 
    \left\lbrace 
    \begin{matrix}
    ik_2 H_3  - \ddr{x_3}{H_ 2} = -i \w \eps E_1 \\
    \ddr{x_3}{H_1} - ik_1 H_3 = -i\w \eps E_2 \\
    ik_1 H_2 - ik_2 H_1 = -i\w \eps E_3 \\
    \end{matrix}
    \right.
\end{align*}

Les composantes normales se déduisant des composantes tangentielles, on résout l'EDO matricielle à coefficients constants 
suivante $\ddr{x_3}{}\v{X} = \mat{M} \v{X}$ où

\begin{equation}
    \v{X} = 
    \begin{bmatrix}
    E_1 \\ 
    E_2 \\ 
    H_1 \\ 
    H_2 \\
    \end{bmatrix}\,,
    \mat{M} = \begin{bmatrix}
    0 & 0 & i\frac{k_1k_2}{\w\eps} & i\left(\w\mu - \frac{k_1^2}{\w\eps}\right)\\
    0 & 0 & -i\left(\w\mu - \frac{k_2^2}{\w\eps}\right) & -i\frac{k_1k_2}{\w\eps}\\
    -i\frac{k_1k_2}{\w\mu} & -i\left(\w\eps - \frac{k_1^2}{\w\mu}\right) & 0 & 0 \\
    i\left(\w\eps - \frac{k_2^2}{\w\mu}\right) & i\frac{k_1k_2}{\w\mu} & 0 & 0 \\
    \end{bmatrix}
\end{equation}

Pour résoudre cette EDO, nous allons chercher les vecteurs propres $V_i$ et les valeurs propres $\lambda_i$ associées de ce système. En effet, une solution générale de ce système s'écrit
\begin{equation}
    \v{X}(x_3)= \sum\limits_{i=1}^{4}c_i e^{\lambda_i x_3} \v{V}_i \, c_i \in \CC
\end{equation}
On pose 
\begin{equation}
    \mat{A} = \begin{bmatrix}
        i\frac{k_1k_2}{i\w\eps} & i\left(\w\mu - \frac{k_1^2}{\w\eps}\right) \\
        -i\left(\w\mu - \frac{k_2^2}{\w\eps}\right) & -i\frac{k_1k_2}{i\w\eps} \\
    \end{bmatrix}
    \quad
    \mat{B} = \begin{bmatrix}
        -i\frac{k_1k_2}{\w\mu} & -i\left(\w\eps - \frac{k_1^2}{\w\mu}\right) \\
        i\left(\w\eps - \frac{k_2^2}{\w\mu}\right) & i\frac{k_1k_2}{\w\mu} \\
    \end{bmatrix}
\end{equation}
Le déterminant de $\mat{M}-\lambda \mat{I}$ est
\begin{align*}
    \det(\mat{M}-\lambda \mat{I}) &= 
    \begin{vmatrix}
        -\lambda \mI & \mA \\
        \mB & -\lambda \mI
    \end{vmatrix}
        = \frac{\det(- \lambda \mI - \mB(-\lambda \mI)^{-1} \mA)}{\det((-\lambda \mI)^{-1})} \\
        &= \det(\lambda^2 \mI - \mB\mA) \\
        &= (\lambda^2 + (\w^2\eps\mu - k_1^2 -k_2^2))^2
\end{align*}
On note alors 
\begin{equation}
k_3=\sqrt{\w^2\eps\mu - k_1^2 -k_2^2}
\end{equation}

Les valeurs propres sont alors 
\begin{equation}
    \lambda_\pm = \pm i k_3
\end{equation}
Les espaces propres associés sont de dimension 2, on a 

\begin{align}
\Ker(\mat{M}-\lambda_+\mI)=\Vect{\v{V_+};\v{W_+}} \\
    \v{V_+} = 
    \begin{bmatrix}
    \lambda_+ \\
        0 \\
        -i\frac{k_1k_2}{\w\mu} \\
        i\left(\w\eps - \frac{k_2^2}{\w\mu}\right) \\
    \end{bmatrix}
    \,
    \v{W_+} = 
        \begin{bmatrix}
        0 \\
        \lambda_+ \\
        -i\left(\w\eps - \frac{k_1^2}{\w\mu}\right) \\
        i\frac{k_1k_2}{\w\mu} \\
    \end{bmatrix}
\end{align}

\begin{align}
\Ker(\mat{M}-\lambda_-\mI)=\Vect{\v{V_-};\v{W_-}}\\
    \v{V_-} = 
    \begin{bmatrix}
        \lambda_- \\
        0 \\
        -i\frac{k_1k_2}{\w\mu} \\
        i\left(\w\eps - \frac{k_2^2}{\w\mu}\right) \\
    \end{bmatrix}
    \,
    \v{W_-} = 
    \begin{bmatrix}
        0 \\
        \lambda_- \\
        -i\left(\w\eps - \frac{k_1^2}{\w\mu}\right) \\
        i\frac{k_1k_2}{\w\mu} \\
    \end{bmatrix}
\end{align}

On a donc une solution générale du système 
\begin{equation}
    \v{X}(x_3) = c_1e^{\lambda_+ x_3}\v{V_+}  + c_2e^{\lambda_+ x_3}\v{W_+} + c_3e^{\lambda_- x_3}\v{V_-} +c_4e^{\lambda_- x_3}\v{W_-} \quad c_i \in \CC
\end{equation}

On exprime les champs $\vE_t(x)$ et $\v{e_3} \times \vH_t(x)$ car ce sont des quantités qui nous intéresse:

\begin{align}
    \begin{bmatrix}
        E_1(x)\\
        E_2(x)\\
    \end{bmatrix}
    &=
    \begin{bmatrix}
        c_1 e^{\lambda_+ x} \lambda_{+} + c_3 e^{\lambda_- x} \lambda_{-} \\
        c_2 e^{\lambda_+ x} \lambda_{+} + c_4 e^{\lambda_- x} \lambda_{-}
    \end{bmatrix}\\
    &=ik_3\left( e^{ik_3 x}
    \begin{bmatrix}
        c_1 \\
        c_2
    \end{bmatrix}
    -e^{-ik_3 x}
    \begin{bmatrix}
        c_3 \\
        c_4
    \end{bmatrix}
    \right)
    \label{eq:imp_fourier:plan:generale_E}
\end{align}

\begin{align}
    \begin{bmatrix}
        -H_2(x)\\
        H_1(x)\\
    \end{bmatrix}
    &=
    \begin{bmatrix}
        -i\left(\w\eps - \frac{k_2^2}{\w\mu}\right) \left( c_1 e^{ik_3 x} + c_3 e^{-ik_3 x} \right) - i\frac{k_1k_2}{\w\mu} \left( c_2 e^{ik_3 x} + c_4 e^{-ik_3 x} \right)
        \\
        -i\frac{k_1k_2}{\w\mu} \left( c_1 e^{ik_3 x} + c_3 e^{-ik_3 x} \right) - i\left(\w\eps - \frac{k_1^2}{\w\mu}\right)\left( c_2 e^{ik_3 x} + c_4 e^{-ik_3 x} \right)
    \end{bmatrix} \\
    &=-i
    \begin{bmatrix}
    \left(\w\eps - \frac{k_2^2}{\w\mu}\right) & \frac{k_1k_2}{\w\mu}
    \\
    \frac{k_1k_2}{\w\mu} & \left(\w\eps - \frac{k_1^2}{\w\mu}\right) 
    \end{bmatrix}
    \left(
        e^{ik_3 x}
        \begin{bmatrix}
            c_1 \\
            c_2
        \end{bmatrix}
        +e^{-ik_3 x}
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
    \right)
    \label{eq:imp_fourier:plan:generale_H}
\end{align}

Notons
\begin{align}
    \mC &=
    \begin{bmatrix}
        \left(\w\eps-\frac{k_2^2}{\w\mu}\right) & \frac{k_1k_2}{\w\mu}\\
        \frac{k_1k_2}{\w\mu} & \left(\w\eps-\frac{k_1^2}{\w\mu}\right)
    \end{bmatrix}
\end{align}

Comme $\det(\mC) = k_3^2\frac{\eps}{\mu}=\frac{k_3^2}{\eta^2}$ alors une condition nécessaire pour trouver l'opérateur d'impédance est que $k_3$ soit non nul\footnote{$k_3$ peut s'annuler pour des $\eps,\mu$ réels.}.
% On peut noter d'après \cite[eq.~(6)]{stupfel_2011}

% \begin{equation}
%     \mC^{-1}= \frac{\eta^2}{k_3^2}\left(k^2\mI - \mat{L_R}\right)
%     \label{eq:imp_fourier:plan:C}
% \end{equation}

\subsection{Plan infini avec une couche}

\begin{thm}
    Si on suppose
        \begin{align}
        k_3d &\not = \frac{\pi}{2}+n\pi\,, \forall n \in \NN
    \end{align}
    Alors l'opérateur d'impédance $\mZ$ est défini par la relation de récurrence : 
    \begin{align}
    \mZ_m &= i\eta\frac{\tan\left(k_3d\right)}{kk_3}
        \begin{bmatrix}
           k^2-k_1^2  & -k_1k_2\\
            -k_1k_2 & k^2-k_2^2\\
        \end{bmatrix}
    \end{align}
\end{thm}

\begin{proof}
    Nous utilisons la condition limite 
    \begin{equation}
        \begin{bmatrix}
            E_1(-d)\\
            E_2(-d)\\
        \end{bmatrix}
        =
        \begin{bmatrix}
            0\\
            0\\
        \end{bmatrix}
    \end{equation}

    De \eqref{eq:imp_fourier:plan:generale_E}, on déduit

    \begin{align}
        \begin{bmatrix}
            c_1 \\
            c_2
        \end{bmatrix}
        = e^{2ik_3 d}
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
    \end{align}

    On définit l'opérateur d'impédance la matrice $\mat Z$ tel que 
    \begin{equation}
        \vE_t(0) = \mat Z \left(\v{e_3} \times \vH_t(0)\right)
    \end{equation}

    De ce qui précède on déduit que,

    \begin{align}
        \begin{bmatrix}
            E_1(0)\\
            E_2(0)\\
        \end{bmatrix}
        &=ik_3\left( e^{i2k_3 d} -1 \right)
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix} \\
        \begin{bmatrix}
            -H_2(0)\\
            H_1(0)\\
        \end{bmatrix}
        & = - i\left(e^{i2k_3 d} +1 \right)
        \mC
        \begin{bmatrix}
        c_3 \\
        c_4
        \end{bmatrix}
    \end{align}

    En supposant $k_3d \not = \frac{\pi}{2} + n\pi$, on déduit donc que
    \begin{align}
        \mat{Z} &=  - k_3 \frac{e^{i2k_3d} -1}{e^{i2k_3d} +1} \mC^{-1} 
        \\
        &= -\frac{\eta^2}{k_3} \frac{e^{i2k_3d} -1}{e^{i2k_3d} +1}
            \begin{bmatrix}
               \left(\w\eps-\frac{k_1^2}{\w\mu}\right)  & -\frac{k_1k_2}{\w\mu}\\
                -\frac{k_1k_2}{\w\mu} &  \left(\w\eps-\frac{k_2^2}{\w\mu}\right)
            \end{bmatrix}
        \\
        &= i\eta\frac{\tan\left(k_3d\right)}{kk_3}
            \begin{bmatrix}
               k^2-k_1^2  & -k_1k_2\\
                -k_1k_2 & k^2-k_2^2\\
            \end{bmatrix}
    \end{align}

\end{proof}
%On remarque que $\det(\mat{Z}) = i\frac{\eta^2}{k_3}\eta\tan(k_3d)$ et donc pour un matériau $(\eps,\mu,d)$ donné, l'opérateur d'impédance n'est pas inversible pour tous  $(k_1,k_2) \in \RR^2, n \in \NN$, $k_1^2+k_2^2 =  \w^2\eps\mu - \frac{1}{d^2}\left(\frac{\pi}{2} + n\pi\right)^2$, qui ne peut être vérifié que si $\eps\mu$ est réel\footnote{Comme $\eps, \mu$ sont à partie réelle (resp. imaginaire) strictement positive (resp. négative), alors ce n'est vrai pour les matériaux à partie imaginaire nulle.}. 

En pratique, on simplifie $k_2 = 0$ soit des solutions se propageant dans le plan $xz$. Grâce à cette hypothèse, on trouve que $\mC, \mZ$ sont des matrices diagonales. 

De plus, on exprime souvent l'impédance selon la polarisation. Dans le cas plan, le champ $\vE$-TE correspond à $E_2 \v{e_2}$, le champ $\vE$-TM à $E_1 \v{e_1}$, tandis que le champ $\vH$-TM correspond à $H_1 \v{e_1}$ et le champ $\vH$-TE correspond à $H_2 \v{e_2}$.
L'opérateur $\mZ$ peut se réécrire comme 
\begin{equation}
    \mZ = 
    \begin{bmatrix}
        Z_{TM} & 0 
        \\
        0 & Z_{TE}
    \end{bmatrix}
\end{equation}

\subsection{Plan infini avec plusieurs couches}
On suppose que l'on a $n$ couches de matériaux : 

\renewcommand{\z}{e_3}
\renewcommand{\x}{e_1}
\renewcommand{\y}{e_2}
\begin{figure}[h!btp]
    \centering
    \begin{tikzpicture}
        \input{tikz/schema/multi_couche.tikz}
    \end{tikzpicture}
\end{figure}

Pour chaque couche caractérisée par $(\eps_m,\mu_m,d_m)$, on définit:
\begin{align}
l_m &= -\sum_{i=1}^{n-m} d_{m} 
\\
k_{3m} &= \sqrt{w^2\eps_m\mu_m - k_2^2 - k_1^2}
\\
\mC_m &=
    \begin{bmatrix}
        \left(\w\eps_m-\frac{k_2^2}{\w\mu_m}\right) & \frac{k_1k_2}{\w\mu_m}\\
        \frac{k_1k_2}{\w\mu_m} & \left(\w\eps_m-\frac{k_1^2}{\w\mu_m}\right)
    \end{bmatrix}
\end{align}

On définit ainsi $\mZ_m$ telle que $\vE_t(l_m) = \mZ_m\vH_t(l_m)$. On cherche donc $\mZ_n$ telle que $\vE_t(0) = \mZ_n\vH_t(0)$

\begin{thm}
    Soit $\mZ_0 = \mat{0}_{\mathcal{M}_2(\CC)}$.

    Si pour tout $0<m < n$
        \begin{align}
        \det\left(k_{3m}\mI \pm \mZ_m\mC_m \right) \not = 0 \\
        k_{3m}d_m\not = \frac{\pi}{2}+n\pi\,, \forall n \in \NN \\
        \det\left(\mI + i\tan(k_{3m}d_m)\mZ_m\mC_m\right) \not = 0
    \end{align}
    Alors pour tout $0< m < n$, l'opérateur d'impédance $\mZ =  \mZ_n$ est défini par la relation de récurrence : 
    \begin{align}
    \mZ_m &= k_{3m}
    \left(i\tan\left(k_{3m}d_m\right)\mI + \mZ_{l_{m-1}}\mC_m\right)
    \left(\mI + i\tan\left(k_{3m}d_m\right)\mZ_{l_{m-1}}\mC_m\right)^{-1}
    \mC_m^{-1}
    \end{align}
\end{thm}

\begin{proof}
    Un empilement à $n$ couches se ramène à un empilement à une couche avec la condition:
    \begin{equation}
        \begin{bmatrix}
            E_1(-d)\\
            E_2(-d)\\
        \end{bmatrix}
        =
        \mat {Z_{d}} 
        \begin{bmatrix}
            -H_2(-d)\\
            H_1(-d)\\
        \end{bmatrix}
    \end{equation}

    On reprend donc tous les résultats de la partie précédente. Notamment, de \eqref{eq:imp_fourier:plan:generale_E} et \eqref{eq:imp_fourier:plan:generale_H}, on déduit que

    \begin{equation}
        \begin{bmatrix}
            E_1(-d)\\
            E_2(-d)\\
        \end{bmatrix}
        = ik_3\left( e^{-ik_3 d}
        \begin{bmatrix}
            c_1 \\
            c_2
        \end{bmatrix}
        -e^{ik_3 d}
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
        \right)
    \end{equation}

    \begin{equation}
        \begin{bmatrix}
            -H_2(-d)\\
            H_1(-d)\\
        \end{bmatrix}
        =-i
        \mC
        \left(
            e^{-ik_3 d}
            \begin{bmatrix}
                c_1 \\
                c_2
            \end{bmatrix}
            +e^{ik_3 d}
            \begin{bmatrix}
                c_3 \\
                c_4
            \end{bmatrix}
        \right)
    \end{equation}

    \begin{equation}
        ik_3\left( e^{-ik_3 d}
        \begin{bmatrix}
            c_1 \\
            c_2
        \end{bmatrix}
        -e^{ik_3 d}
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
        \right)
        =-i\mat{Z_d}\mC
        \left(
            e^{-ik_3 d}
            \begin{bmatrix}
                c_1 \\
                c_2
            \end{bmatrix}
            +e^{ik_3 d}
            \begin{bmatrix}
                c_3 \\
                c_4
            \end{bmatrix}
        \right)
    \end{equation}

    \begin{equation}
        \left(k_3\mI + \mat{Z_d}\mC\right)
        \begin{bmatrix}
            c_1 \\
            c_2
        \end{bmatrix}
        = e^{i2k_3 d} \left(k_3\mI - \mat{Z_d}\mC\right)
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
    \end{equation}

    On pose
    \begin{align}
        \mA_\pm &= k_3\mI \pm \mat{Z_d}\mC
    \end{align}

    On remarque que par définition, $\mA_+$ et $\mA_-$ commutent.

    Pour continuer il faut exprimer un vecteur en fonction de l'autre. On suppose donc $\pm k_3$ ne sont pas des valeurs propres de $\mat{Z_d}\mC$ et l'on déduit que

    \begin{align}
        \begin{bmatrix}
            c_1 \\
            c_2
        \end{bmatrix}
        &= e^{i2 k_3 d} \mA_+^{-1}\mA_-
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
        \\
        & = \mat{F}
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
    \end{align}

    \begin{align}
        \begin{bmatrix}
            E_1(0)\\
            E_2(0)\\
        \end{bmatrix}
        &=ik_3\left(\mat{F} - \mI \right)
        \begin{bmatrix}
            c_3 \\
            c_4
        \end{bmatrix}
    \end{align}

    \begin{align}
        \begin{bmatrix}
            -H_2(0)\\
            H_1(0)\\
        \end{bmatrix}
        &=-i\mC \left(  \mat{F} + \mI  \right)
        \begin{bmatrix}
                c_3 \\
                c_4
        \end{bmatrix}
    \end{align}

    On suppose qu'en plus de $\mA_+$ et $\mA_-$, $\mat{F} + \mI$ est inversible, on va utiliser la commutativité de $\mA_+$ et $\mA_-$.

    Alors l'opérateur d'impédance $\mat{Z}$ s'exprime

    \begin{align}
        \mat{Z}
        &=-k_3\left(\mat{F} - \mI \right)\left(\mat{F}+ \mI \right)^{-1}\mC^{-1}
        \\
        &=-k_3\mA_+^{-1}\left(e^{i2 k_3 d}\mA_- - \mA_+ \right)\left(e^{i2 k_3 d}\mA_- + \mA_+ \right)^{-1}\mA_+\mC^{-1}
        \\
        &= -k_3\left( e^{i2 k_3 d} \mA_- -  \mA_+\right)
        \left( e^{i2 k_3 d} \mA_- + \mA_+ \right)^{-1}\mC^{-1}
        \\
        &= -k_3\left(\left( e^{i2 k_3 d} - 1 \right)\mI - \left( e^{i2 k_3 d} + 1 \right) \mat{Z_d}\mC \right)
        \left( \left( e^{i2 k_3 d} + 1 \right)\mI - \left( e^{i2 k_3 d} - 1 \right)\mat{Z_d}\mC \right)^{-1}\mC^{-1}   
    \end{align}

    En supposant que $\forall n \in \NN \,, k_3d\not = \frac{\pi}{2}+n\pi$, on a

    \begin{equation}
    \mZ = k_3\left(i\tan(k_3 d)\mI + \mat{Z_d}\mC \right)
        \left( \mI + i\tan(k_3 d)\mat{Z_d}\mC \right)^{-1}\mC^{-1} 
    \end{equation}

    à condition que 
    \begin{align}
        \det\left(k_3\mI \pm \mat{Z_d}\mC \right) \not = 0 \\
        k_3d\not = \frac{\pi}{2}+n\pi\,, \forall n \in \NN \\
        \det\left(\mI + i\tan(k_3d)\mat{Z_d}\mC\right) \not = 0
    \end{align}

    \TODO{
        Expliciter les résultats dans le cas $k_1 = 0$ , $k_2 = k_0s$.
    }



\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% CYLINDRE

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\subsection{Forme générale des solutions pour un cylindre recouvert de matériau homogène isotrope}

On rappelle les formules des opérateurs $\vdiv, \vrot$ en coordonnée cylindrique $(r,\theta,z)$.
\begin{align}
    \vrot \v{V} &= \left(\frac{1}{r}\ddr{\theta}{V_z} - \ddr{z}{V_\theta}\right)\v{e_r} + 
    \left(\ddr{z}{V_r} - \ddr{r}{V_z}\right)\v{e_\theta} +
    \frac{1}{r}\left(\ddr{r}{(rV_\theta)}-\ddr{\theta}{V_r}\right)\v{e_z} 
    \\
    \vdiv \v{V} &= \frac{1}{r}\ddr{r}{(rV_r)}+\frac{1}{r}\ddr{\theta}{V_\theta}+\ddr{z}{V_z}
\end{align}

\newcommand{\mr}{r}
\newcommand{\mt}{\theta}
\newcommand{\mz}{z}

\begin{figure}[!hbt]
    \centering
    \begin{tikzpicture}
        \input{tikz/schema/cylindre.tikz}
    \end{tikzpicture}
\end{figure}

On exprime les équations de Maxwell dans le matériau dans cette base et sans pertes de généralité, on peut réaliser une transformée de Fourier en $z$ par invariance en translation et en $\theta$ par invariance en rotation. Cependant, le multiplicateur de Fourier associé à la coordonnée $\theta$ doit être un entier pour assurer la périodicité. On le note $n$.

\begin{align}
    \vrot \vE &= i\left(\frac{n}{r}E_z - k_zE_\theta\right)\v{e_r} + 
    \left(ik_zE_r - \ddr{r}{E_z}\right)\v{e_\theta} +
    \frac{1}{r}\left(\ddr{r}{(rE_\theta)}-inE_r\right)\v{e_z}
    \\
    &=i\w\mu \vH
\end{align}

On remarque que dans ce cas, la méthode utilisée pour le plan aboutie à une EDO à coefficients non constant de type $r\ddr{r}{X}(r) = M(r)X(r)$.


\TODO{
    Passer en cylindrique. Développer $\vrot \vrot$ et trouver des équations de Bessel pour $E_z$, $H_z$.
    \[
    r^2\ddr[2]{r}{E_z} + r\ddr{r}{E_z} + (r^2 - n^2) E_z = 0
    \]
     Déduire $E_r$,$H_r$,$E_\theta$,$H_\theta$. Trouver $\mat{Z}$
}

On ne peut pas exprimer la solution avec les valeurs et vecteurs propres de la matrice. 
%Nous allons donc trouver une équation de Bessel en développant le système de Maxwell.
On développe le système de Maxwell:

\begin{align}
    \vrot \vrot \vE &= \w^2\eps\mu \vE
    \\
    \vdiv \vE &= 0
\end{align}

\begin{multline}
    \vrot \vrot \vE = \dots\\
    i\left(\frac{n}{r^2}\left(\ddr{r}{(rE_\theta)} - inE_r\right) - k_z\left(ik_zE_r - \ddr{r}{E_z}\right)\right)    \v{e_r} \dots\\ 
    + \left(-k_z\left(\frac{n}{r}E_z - k_zE_\theta\right) -\ddr{r}{}\left(\frac{1}{r}\left(\ddr{r}{(rE_\theta)}-inE_r\right)\right)\right)    \v{e_\theta} \dots\\
    + \frac{1}{r}\left(\ddr{r}{} \left(r\left(ik_zE_r - \ddr{r}{E_z}\right)\right) + n \left(\frac{n}{r}E_z - k_zE_\theta\right)\right) \v{e_z}
\end{multline}

On aboutit au système suivant,
\begin{equation}
    \left\lbrace
    \begin{array}{ccc}
        -\left(\w^2\eps\mu -\frac{n^2}{r^2}  - k_z^2\right)E_r  +i\frac{n}{r^2}\ddr{r}{(rE_\theta)}  +k_z\ddr{r}{E_z} & = & 0\\
        in\ddr{r}{}\left(\frac{E_r}{r}\right) -\left(\w^2\eps\mu - k_z^2\right)E_\theta + \ddr{r}{}\left(\frac{1}{r}\ddr{r}{(rE_\theta)}\right)  - n\frac{k_z}{r}E_z & = & 0\\
        i\frac{k_z}{r}\ddr{r}{(rE_r)}  - n\frac{k_z}{r}E_\theta  -\left(\w^2\eps\mu - \frac{n^2}{r^2} \right)E_z - \frac{1}{r}\ddr{r}{}\left(r\ddr{r}{E_z}\right) & = & 0
    \end{array}
    \right.
\end{equation}

Comme l'on cherche $\vE_t, \vH_t$, on cherche une équation différentielle à résoudre sur $E_z$, puis on en déduira $\vE_t$.

De la troisième  équation, on trouve pour $r\not=0$
\begin{equation}
r^2 \ddr[2]{r}{E_z} + r\ddr{r}{E_z} + \left(r^2\w^2\eps\mu - n^2\right)E_z =ik_zr\ddr{r}{(rE_r)} -  nk_zrE_\theta
\end{equation}

\TODO{Vérifier que $\vdiv\vrot\v{V} = 0$ en cylindrique.}

Or comme $\vdiv \vE = i\w\mu\vdiv\vrot\vH = 0$, on a
\begin{align}
    \vdiv\vE &= \frac{1}{r}\ddr{r}{(rE_r)} + \frac{in}{r}E_\theta + ik_zE_z
    \\
    &=0
    \\
    k_z^2r^2 E_z &= ik_zr\ddr{r}{(rE_r)} - nk_zrE_\theta
\end{align}

On obtient donc une équation sur la composante $E_z$:
\begin{equation}
    r^2 \ddr[2]{r}{E_z} + r\ddr{r}{E_z} + \left(r^2\left(\w^2\eps\mu - k_z^2\right) - n^2\right)E_z = 0
\end{equation}
\TODO{Que ce passe t'il si je prend des fonctions de Bessel différentes ? }
On pose 
\begin{equation}
    k_3 = \sqrt{w^2\eps\mu - k_z^2}
\end{equation}

C'est une équation de Bessel (cf \cite[eq (6.80)]{bowman_introduction_1958}), dont des solutions générales sont: soient $(C_1,C_2) \in \CC^2$:
\TODO{Expliquer que ces choix viennent de la condition limite infini. L'introduire ?}
\begin{equation}
    E_z = C_1 J_n\left(k_3r\right) + C_2 H_n^{(2)}\left(k_3r\right)
\end{equation}
où $J_n$ est la fonction de Bessel du premier type, $H_n^{(2)}$ la fonction de Hankel de deuxième type. 

On trouve exactement le même résultat pour $H_z$: soient $(C_3,C_4) \in \CC^2$
\begin{equation}
    H_z = C_3 J_n\left(k_3r\right) + C_4 H_n^{(2)}\left(k_3r\right)
\end{equation}

À partir des équations de Maxwell restante, on peut déterminer $E_r,E_\theta,H_r,H_\theta$.
\begin{equation}
    \left\lbrace
    \begin{matrix}
        -ik_zE_\theta - i\w\mu H_r = -\frac{in}{r}E_z
        \\
        ik_zE_r - i\w\mu H_\theta = \ddr{r}{E_z}
        \\
        -i\w\eps E_r + ik_z H_\theta = \frac{in}{r}H_z
        \\
        -i\w\eps E_\theta - ik_z H_r = -\ddr{r}{H_z}
    \end{matrix}
    \right.
\end{equation}

Cela revient à résoudre $\v{Y}= \mat{M}\v{X}$ où la matrice $\mat{M}$ et les vecteurs $\v{X}, \v{Y}$ sont définis tels que
\begin{equation}
    \mat{M} =
    \begin{bmatrix}
    0 & -ik_z & -i\w\mu & 0 
    \\
    ik_z & 0 & 0 & -i\w\mu
    \\
    -i\w\eps & 0 & 0 & ik_z
    \\
    0 & -i\w\eps & -ik_z & 0
    \end{bmatrix}
    \,,
    \v{X} = 
    \begin{bmatrix}
        E_r\\
        E_\theta\\
        H_r\\
        H_\theta
    \end{bmatrix}
    \,,
    \v{Y} = 
    \begin{bmatrix}
        -\frac{in}{r}E_z\\
        \ddr{r}{E_z}\\
        \frac{in}{r}H_z\\
        -\ddr{r}{H_z}
    \end{bmatrix}
    \,,
\end{equation}

À condition que $\det(\mat{M}) = (\w^2\eps\mu-k_z^2)^4$ soit non nul, peut déduire $\vE_t$ et $\v{e_r}\times \vH_t$:

\begin{align}
    E_\theta &= 
    \\
    E_z &= 
\end{align}

\begin{align}
    -H_z &= 
    \\
    H_\theta &= 
\end{align}